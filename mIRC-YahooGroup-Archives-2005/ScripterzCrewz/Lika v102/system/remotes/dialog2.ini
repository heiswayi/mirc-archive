[script]
n0=
n1=;###########
n2=;Progress BAR
n3=;##############
n4=dialog pbar {
n5=  title $name rules!
n6=  icon system\images\about.ico, 0
n7=  size -1 -1 207 49
n8=  option pixels
n9=  text "", 1, 10 10 187 16, center
n10=  box "", 2, 2 -2 203 50
n11=  text "pbar", 3, 10 30 187 11
n12=  button "", 98, 183 1 13 14, hide
n13=  button "", 99, 197 1 13 14, hide ok
n14=}
n15=on *:dialog:pbar:init:0:{
n16=  mdx.init $dname
n17=  mdx.fonts $dname 1
n18=  mdx SetControlMDX $dname 98 Positioner noclose > $mddlg
n19=  mdx SetControlMDX $dname 3 ProgressBar smooth > $mdgen
n20=  did -ra $dname 3 barcolor $rgb(69,117,151)
n21=}
n22=alias pbar if (!$dialog(pbar)) { dialog -m pbar pbar } | dialog -ve pbar | did -ra pbar 3  $1 0 $2 | $iif($3,did -ra pbar 1 $3-) | $iif($1 >= $2,dialog -k pbar)
n23=
n24=;###########
n25=;TIPS
n26=;##############
n27=alias tips { $wdialog(tips) }
n28=dialog tips {
n29=  title "Helpful Tips [/tips]"
n30=  size -1 -1 295 93
n31=  icon system\images\tips.ico, 0
n32=  text "Configure most of $name's options by typing /cpanel", 2, 57 14 232 45
n33=  button "Next", 3, 215 65 75 25
n34=  button "Button", 5, 65 83 75 25, hide ok
n35=  icon 6, 14 16 32 32, system\images\tips.ico, 0
n36=}
n37=on *:dialog:tips:*:*:{
n38=  var %x = $ini(system\misc\help.ini,help:tips,0)
n39=  if ($devent == init) { did -ra $dname 2 $readini(system\misc\help.ini,help:tips,$rand(1,%x)) }
n40=  if ($devent == sclick) && ($did == 3) { did -ra $dname 2 $readini(system\misc\help.ini,help:tips,$rand(1,%x)) }
n41=}
n42=
n43=
n44=;###########
n45=;HELP/ABOUT/COMMANDS
n46=;##############
n47=alias commands set %help com | help2
n48=alias help2 { $wdialog(help) }
n49=dialog help {
n50=  title "Help Center [/help2]"
n51=  size -1 -1 449 274
n52=  option pixels
n53=  icon system\images\help.ico, 0
n54=  list 1, 5 5 127 226, size vsbar
n55=  box "", 2, 3 -1 130 233, hide
n56=
n57=  button "Button", 99, 357 238 75 25, hide ok
n58=  edit "", 4, 139 6 307 227, hide read multi return vsbar
n59=  list 97, 11 243 421 18, size
n60=  list 6, 3 6 440 227, hide size
n61=  box "", 98, 3 231 446 40
n62=  text "", 420, 1 1 50 16, hide
n63=
n64=  box "about", 333, 138 6 307 225
n65=}
n66=
n67=
n68=alias help.2 { return $readini(system\misc\help.ini,help,$1) }
n69=on *:dialog:help:*:*:{
n70=  if ($devent == init) {
n71=    mdx.fonts $dname 1,2,3,4,99,97,6,98,14,20,21
n72=    mdx SetBorderStyle 4 staticedge
n73=    mdx SetControlMDX $dname 97 ToolBar nodivider list flat wrap > $mdbars
n74=    ;  did -i $dname 97 1 pad 10 8
n75=    did -i $dname 97 1 bmpsize 16 16
n76=    mdx SetBorderStyle 97
n77=    var %d =   did -i $dname 97 1 setimage +nhd icon small 
n78=    %d system\images\help.ico
n79=    %d system\images\fkey.ico
n80=    %d system\images\about.ico
n81=
n82=    did -a $dname 97 $+(+cg,$iif(!%help,x)) 1 Contents $chr(9) Help Topics for the script features and addons $chr(9) help.show 1;333,4,6
n83=    did -a $dname 97 $+(+cg,$iif(com isin %help,x)) 2 Commands $chr(9) The most used Commands $chr(9)  help.show 6;1,4,2,333
n84=    did -a $dname 97 3 About $chr(9) About the Script $chr(9)  about
n85=
n86=    var %d = 1,%b = 1
n87=    while ($gettok($help.2(topics),%d,169) != $null) { whilefix | did -a $dname 1 $gettok($help.2(topics),%d,169) | inc %d }
n88=    if ($help.2(addons)) { while ($gettok($help.2(addons),%b,169) != $null) { did -a $dname 1 $replace($gettok($help.2(addons),%b,169),$chr(95),$chr(32)) | inc %b } }
n89=    did -c $dname 1 1
n90=    did -ra $dname 4 Topic: $did(1).seltext $crlf $str(¯,46) $crlf  | var %r = 1 | while ($readini(system\misc\help.ini,about,%r)) { did -a $dname 4 $readini(system\misc\help.ini,about,%r) | inc %r } | did -c $dname 4 1 
n91=
n92=    var %hwnd = $dll($nhtml,find,about) 
n93=    dll $nhtml attach %hwnd
n94=    dll $nhtml navigate $mircdirsystem\misc\index.html
n95=
n96=    mdx SetControlMDX $dname 6 listview rowselect sortascending showsel single labeltip $rcon(display,list.style) > $views
n97=    did -i $dname 6 1 headerdims 90:1 300:2
n98=    did -i $dname 6 1 headertext /commands $chr(9) Info
n99=    var %c = 1
n100=    while ($ini(system\misc\help.ini,help:com,%c)) {
n101=      whilefix
n102=      var %txt = $ini(system\misc\help.ini,help:com,%c)
n103=      did -a $dname 6 %txt $chr(9) $readini(system\misc\help.ini,help:com,%txt)
n104=      inc %c
n105=    }
n106=
n107=
n108=    if (com isin %help) { help.show b 6;1,4,2,333 }
n109=    unset %help
n110=
n111=  }
n112=  if ($devent == sclick) { 
n113=    var %x = $did(1).seltext  
n114=
n115=    var %a = $iif($did(1).sel > $numtok($help.2(topics),169),y,n) | if (%a == y)  { var %x = $replace($did(1).seltext,$chr(32),$chr(95)) }
n116=    if (($did == 1)  && ($did(1).seltext != about)) { 
n117=      did -ra $dname 4 Topic: $did(1).seltext $crlf $str(¯,46) $crlf  
n118=      var %r = 1 
n119=      while ($readini(system\misc\help.ini,%x,%r)) { did -a $dname 4 $replace($readini(system\misc\help.ini,%x,%r),<crlf>,$crlf) | inc %r } 
n120=
n121=    }  
n122=
n123=    var %b = $iif($gettok($did($dname,97).seltext,1,9),$v1,cont)
n124=
n125=    if (abou !isin %b) did -ra $dname 420 %b
n126=
n127=    if ($did == 97) {  var %a = $gettok($did($dname,97).seltext,3,9) | if (%a) %a    }
n128=    if ((%x == about) && (cont isin $did(420) ))  { .timer 1 0 did -v help 333 | did -h $dname 4 } 
n129=    elseif ((%x != about) && (cont isin $did(420) ) ) { did -h help 4,333 | .timer 1 0 did -v help 4 }   
n130=
n131=  }
n132=}
n133=alias help.show {   did -v help $gettok($2,1,59)  |   did -h help $gettok($2,2,59) }
n134=
n135=
n136=
n137=
n138=;###########
n139=;WORD REPLACEr
n140=;##############
n141=
n142=alias word { $wdialog(word) }
n143=dialog word {
n144=  title "Word replacer [/word]"
n145=  size -1 -1 317 181
n146=  icon system\images\word.ico, 0
n147=  list 2, 3 0 310 142, size
n148=  text "$name", 100, 222 250 37 16
n149=  button "Add", 12, 154 150 75 25
n150=  button "Remove", 11, 237 150 75 25
n151=  text $name, 1, 31 151 50 16
n152=  menu "File", 24
n153=  item "Close", 25, 24, ok
n154=  menu "Enable", 26
n155=  item "Word Replacer", 27, 26
n156=}
n157=on *:dialog:word:menu:*:{
n158=  if ($did == 25) { dialog -x word }
n159=  if ($did == 27) { if ($rcon(wr,status) == on) { $wcon(wr,status,off) | did -u $dname $did } | else { $wcon(wr,status,on) | did -c $dname $did } } 
n160=}
n161=on *:dialog:word:init:0:{
n162=  mdx.init $dname
n163=  mdx.fonts $dname 2,100,5,6,7,8,4,23,9,10,12,11,98
n164=  mdx.buttons $dname 10,11,12,9
n165=  mdx SetControlMDX $dname 2 listview icon smallicons alignleft rowselect showsel single labeltip $rcon(display,list.style) > $views 
n166=  did -i $dname 2 1 headerdims 75:1 190:2
n167=  did -i $dname 2 1 headertext Input $+ $chr(9) $+ Replace
n168=  if ($rcon(wr,status) == on) { did -c $dname 27 }
n169=  load.wr
n170=}
n171=alias load.wr {
n172=  did -r word 2 | var %a  = 1
n173=  while ($ini($+($prodir,opt.ini),wrt,%a)) {
n174=    did -i word 2 1 seticon list 0 system\images\word.ico
n175=    did -a word 2 0 1 $ini($+($prodir,opt.ini),wrt,%a) $chr(9) $rini(opt.ini,wrt,$ini($+($prodir,opt.ini),wrt,%a))
n176=    inc %a
n177=  }
n178=}
n179=on *:dialog:word:sclick:*:{
n180=  var %s = $calc($did($dname,2).sel - 1)
n181=  var %txt = $right($gettok($did($dname,2).seltext,1,9),-12)
n182=  if ($did == 12) { var %i = $$?="Text to replace" | var %r = $$?="Replace with?" | if (%i) && (%r) { $wcon(wrt,%i,%r) | load.wr } }
n183=  if ($did == 11) { $dini($+($prodir,opt.ini),wrt,%txt) | load.wr }
n184=}
n185=
n186=on *:input:*:{ 
n187=  if ($0) && ((/* !iswm $1) || ($ctrlenter)) && (($active ischan) || ($query($active)) || (=* iswm $active)) && ($window($active, 0) = 1) {
n188=
n189=    say $wr($1-) | halt
n190=  }
n191=}
n192=
n193=
n194=;###########
n195=;USERLIST
n196=;##############
n197=dialog userlist {
n198=  title "Userlist Manager [/userlist]"
n199=  size -1 -1 374 191
n200=  icon system\images\userlist.ico, 0
n201=  list 1, 6 3 362 148, size
n202=  button "Add", 5, 212 159 75 25
n203=  button "Remove", 6, 293 159 75 25
n204=  text $name, 99, 51 164 38 16
n205=  menu "File", 80
n206=  item "Close", 81, 80, ok
n207=  menu "Enable", 82
n208=  item "Auto-Op", 83, 82
n209=  item "Auto-Voice", 84, 82
n210=  item "Protect", 85, 82
n211=  item "Shitlist", 86, 82
n212=}
n213=alias userlist { $wdialog(userlist) }
n214=on *:dialog:userlist:init:0:{
n215=  mdx.init $dname
n216=  mdx.buttons $dname 5,6
n217=  mdx.fonts $dname 1,5,6,99
n218=  mdx SetControlMDX $dname 1 listview $rcon(display,list.style) sortascending rowselect  > $views 
n219=  did -i $dname 1 1 headerdims 175:1 70:2 110:3
n220=  did -i $dname 1 1 headertext Address $chr(9) Level $chr(9) Channels
n221=  userlist.load
n222=  if ($aop) did -c $dname 83
n223=  if ($avoice) did -c $dname 84
n224=  if ($protect) did -c $dname 85
n225=  if ($rcon(userlist,shit) == on) did -c $dname 86
n226=}
n227=on *:dialog:userlist:sclick:*:{
n228=  if ($did == 5) { $adduser | userlist.load }
n229=  if ($did == 6) { 
n230=    var %t = $right($gettok($did($dname,1).seltext,2,9),-11)
n231=    if (%t == Auto-Op) { .aop -r $right($gettok($did($dname,1).seltext,1,9),-12) | userlist.load }
n232=    if (%t == Auto-Voice) { .avoice -r $right($gettok($did($dname,1).seltext,1,9),-12) | userlist.load }
n233=    if (%t == Protect) { .protect -r $right($gettok($did($dname,1).seltext,1,9),-12) | userlist.load }
n234=    if (%t == ShitList) { .ruser shit $right($gettok($did($dname,1).seltext,1,9),-12) | userlist.load }
n235=  }
n236=}
n237=on *:dialog:userlist:menu:*:{
n238=  if ($did == 83) { if ($aop) { .aop off | did -u $dname $did } | else { .aop on | did -c $dname $did } }
n239=  if ($did == 84) { if ($avoice) { .avoice off | did -u $dname $did } | else { .avoice on | did -c $dname $did } }
n240=  if ($did == 85) { if ($protect) { .protect off | did -u $dname $did } | else { .protect on | did -c $dname $did } }
n241=  if ($did == 86) { if ($rcon(userlist,shit) == on) { $wcon(userlist,shit,off) | did -u $dname $did } | else { $wcon(userlist,shit,on) | did -c $dname $did } }
n242=}
n243=alias userlist.load { 
n244=  did -r userlist 1
n245=  var %o = 1,%v = 1,%p = 1,%s = 1
n246=  while $aop(%o) { did -a userlist 1 $aop(%o) $chr(9) Auto-Op $chr(9) $aop(%o).type | inc %o }
n247=  while $avoice(%v) { did -a userlist 1 $avoice(%v) $chr(9) Auto-Voice $chr(9) $avoice(%v).type | inc %v }
n248=  while $protect(%p) { did -a userlist 1 $protect(%p) $chr(9) Protect $chr(9) $protect(%p).type | inc %p }
n249=  while $ulist(*,shit,%s) { did -a userlist 1 $ulist(*,shit,%s) $chr(9) ShitList $chr(9) $ulist(*,shit,%s).info | inc %s }
n250=}
n251=
n252=alias adduser { $wdialog(adduser) }
n253=dialog adduser {
n254=  title "Add User [/adduser]"
n255=  size -1 -1 264 139
n256=  icon system\images\userlist.ico, 0
n257=  box "", 1, 7 3 251 96
n258=  text "Address:", 2, 20 26 70 16
n259=  text "Channels:", 4, 20 47 69 16
n260=  text "Level:", 6, 20 69 30 15
n261=  edit "", 3, 89 20 158 22, autohs
n262=  edit "", 5, 89 42 158 22, autohs
n263=  combo 7, 90 65 157 100, size drop
n264=  button "Add", 8, 99 106 75 25, 
n265=  button "Cancel", 9, 182 106 75 25, ok
n266=  text $name, 24, 21 111 38 16
n267=}
n268=on *:dialog:adduser:init:0:{
n269=  mdx.fonts $dname 1,2,4,6,3,5,7,8,9,24
n270=  mdx.buttons $dname 8,9
n271=  var %d = did -a $dname 7
n272=  %d Auto-Op
n273=  %d Auto-Voice
n274=  %d Protect
n275=  %d Shitlist
n276=}
n277=on *:dialog:adduser:sclick:8:{
n278=  if (!$did(3)) { derror Error Invalid Address | halt }
n279=  if (!$did(5)) { error Invalid Channels. | halt }
n280=  if (!$did(7)) { derror Error Invalid Level. Please Select a Level | halt }
n281=  if ($did(7).sel == 1) { .aop $did(3) $did(5) }
n282=  if ($did(7).sel == 2) { .avoice $did(3) $did(5) }
n283=  if ($did(7).sel == 3) { .protect $did(3) $did(5) }
n284=  if ($did(7).sel == 4) { .auser shit $did(3) $did(5) }
n285=  if ($dialog(userlist)) { userlist.load | dialog -x adduser adduser }
n286=}
n287=
n288=alias msg.defaults {
n289=  if ($1 == leave) { return $brac(Leaving) $fm(Reason, %away.reason) $fm(Pager, $iif($rcon(away,pager) == on, /ctcp $me PAGE <msg>,Off)) $l }
n290=  if ($1 == away) { return $brac(Away) $fm(Reason,%away.reason)  $fm(Duration,$duration($calc($ctime - $rcon(away,time))))  $fm(Pager, $iif($rcon(away,pager) == on, /ctcp $me PAGE <msg>,Off)) $l } 
n291=  if ($1 == back)  { return $brac(Back) $fm(Reason,%away.reason) $fm(Duration,$duration( $calc($ctime - $rcon(away,time)))) $l }
n292=
n293=}
n294=
n295=
n296=;############ ;####         #####
n297=;############  ;###   ###   ###
n298=;                #####  ;###   ###   ###
n299=;############  ;###   ###   ###
n300=;####       #####  ;###   ###   ###
n301=;####       #####  ;###   ###   ###
n302=;############ ;############
n303=;############ ;############
n304=
n305=alias awayopt {
n306=
n307=  if (($1 == auto) && ($rcon(away,auto) == on))  {
n308=    var %a = 1
n309=    while ($scon(%a)) { 
n310=      scon %a
n311=      if (!$server) { inc %a | continue }
n312=      if ($away) { inc %a | continue }
n313=      if ($idle > $calc($rcon(away,autoint) * 60)) { 
n314=        if ($rcon(away,global) == on) { setaway Auto away after $rcon(away,autoint) mins | break  }
n315=        else { setaway Auto away after $rcon(away,autoint) mins }
n316=      }
n317=      inc %a
n318=    }
n319=
n320=
n321=    else { return }
n322=  }
n323=
n324=  if ($1 == ad1) { return $iif($rcon(away,msg.custom) == on,$away.msgrep(msg.away),$msg.defaults(away)) }
n325=  if ($1 == ad2) { return $iif($rcon(away,msg.custom) == on,$away.msgrep(msg.back),$msg.defaults(back)) }
n326=
n327=  if ($1 == globalback) {
n328=    $wcon(stats,awaytime,$calc(($ctime - $rcon(away,time)) + $rcon(stats,awaytime))) 
n329=    $away.msg(ad2) | .timerawayAD off
n330=
n331=    while ($scon(%a)) { 
n332=      scon %a
n333=      if (!$server) { inc %a | continue }
n334=      if (!$away) { inc %a | continue }
n335=      if ($rcon(away,cnick) == on) && ($rcon(away,rnick) != $null) { nick $rcon(away,rnick) } 
n336=      away | inc %a 
n337=    }
n338=  }
n339=
n340=  if ($1 == global) {
n341=    var %a = 1
n342=    if ($rcon(away,msg) == on) && ($rcon(away,int) isnum) { .timerawayAD 0 $calc($rcon(away,int) * 60) away.msg ad1 } 
n343=    while ($scon(%a)) { 
n344=      scon %a
n345=      if (!$server) { inc %a | continue }
n346=      if ($away) { inc %a | continue }
n347=
n348=      If ($rcon(away,doav) == on) { var %c = 1 | while (%x <= $chan(0)) {  if ($me isop $chan(%c)) { mode $chan(%c) -o+V $me  } |  inc %c   }   }
n349=      away %away.reason
n350=      $wcon(away,time,$ctime) 
n351=      if ($rcon(away,cnick) == on) && ($rcon(away,nick)) { $wcon(away,rnick,$me) | nick $replace($rcon(away,nick),<me>,$me) }
n352=
n353=      inc %a
n354=    }
n355=
n356=  }
n357=  if ($1 == pager) {     If ($rcon(away,pager) == on) { return /ctcp $me PAGE <msg> } | else { return Off }   }
n358=
n359=  elseif (!$isid) { awaysetup }
n360=
n361=}
n362=
n363=alias away.msgrep {
n364=  if ($1 == msg.away) || ($1 == msg.back) { return $replace($rcon(away,$1),<pager>,$awayopt(pager),<time>,$duration( $calc($ctime - $rcon(away,time))),<reason>,%away.reason ) }
n365=  else { return $replace($1-,<pager>,$awayopt(pager),<time>,$duration(260),<reason>,$read($+($prodir,reasons.txt)) ) }
n366=
n367=}
n368=
n369=
n370=alias away.msg {
n371=  var %a = 1
n372=  while ($scon(%a)) { 
n373=    scon %a
n374=    if (!$server) { inc %a | continue }
n375=    if (!$away) { inc %a | continue }
n376=    if ($rcon(away,msg.allchan) == on) {  var %c = 1 |  while (%c <= $chan(0)) { $rcon(away,msg.awaym) $chan(%c) $awayopt($1) | inc %c }   }
n377=    else {
n378=      var %b = 1
n379=      while ($gettok($rcon(away:chans,$network),%b,44)) { $rcon(away,msg.awaym)  $gettok($rcon(away:chans,$network),%b,44) $awayopt($1) |  inc %b   }
n380=    }
n381=    inc %a
n382=  }
n383=
n384=}
n385=
n386=alias setaway { 
n387=  if ($1 == -r) { $wdialog(reasons) | return } 
n388=  if ($1 == -b) { setback | return } 
n389=  if ($1 == help) { echo help> sets you away/back; /setaway  < -r | -b > | return  }
n390=  else { 
n391=    if (!$server) || ($away) { return }
n392=    set %away.reason $iif($1,$1-,$$?="Reason")
n393=    if ($rcon(away,global) == on) { $awayopt(global) }
n394=    else {
n395=
n396=      If ($rcon(away,doav) == on) { var %c = 1 | while (%x <= $chan(0)) {  if ($me isop $chan(%c)) { mode $chan(%c) -o+V $me  } |  inc %c   }   }
n397=      away %away.reason 
n398=      $wcon(away,time,$ctime) 
n399=      if ($rcon(away,cnick) == on) && ($rcon(away,nick)) { $wcon(away,rnick,$me) | nick $replace($rcon(away,nick),<me>,$me) }
n400=      if ($rcon(away,msg) == on) && ($rcon(away,int) isnum) { .timerawayAD 0 $calc($rcon(away,int) * 60) away.msg ad1 } 
n401=    }
n402=  }
n403=}
n404=alias setaway2 { setaway -r }
n405=alias setback {
n406=  if ($rcon(away,global) == on) { $awayopt(globalback) | return }
n407=  if ($away) { 
n408=    $wcon(stats,awaytime,$calc(($ctime - $rcon(away,time)) + $rcon(stats,awaytime))) 
n409=    away | .timerawayAD off
n410=    if ($rcon(away,cnick) == on) && ($rcon(away,rnick) != $null) { nick $rcon(away,rnick) } 
n411=
n412=    $away.msg(ad2)
n413=  }
n414=
n415=}
n416=
n417=dialog reasons {
n418=  title "Select Reason [/setaway2]"
n419=  size -1 -1 267 203
n420=  icon system\images\away.ico, 0
n421=  list 1, 5 4 256 163, size hsbar vsbar
n422=  button "Add", 2, 6 173 50 25
n423=  button "Rem", 3, 55 173 50 25
n424=  button "Away", 4, 162 173 50 25
n425=  button "Cancel", 5, 211 173 50 25, default cancel
n426=  button "Back", 6, 162 173 50 25, hide
n427=}
n428=on *:dialog:reasons:*:*:{
n429=  if ($devent == init) { reasons.load | if ($away) { did -h $dname 4 | did -v $dname 6 } }
n430=  if ($devent == sclick) {
n431=    if ($did == 2) { var %reason = $$?="Enter New Reason" | if (%reason) { write $+($prodir,reasons.txt) %reason | reasons.load } }
n432=    if ($did == 3) { write -dl $+ $did($dname,1).sel $+($prodir,reasons.txt) | reasons.load }
n433=    if ($did == 4) { if ($did($dname,1).sel isnum) { setaway $did($dname,1).seltext |  did -h $dname 4 | did -v $dname 6 } | else { derror Error Invalid Reason. Please select a reason } }
n434=    if ($did == 6) { setback | did -h $dname 6 | did -v $dname 4 }
n435=  }
n436=}
n437=
n438=alias reasons.load { did -r reasons 1 | var %r = 1 |  while $read($+($prodir,reasons.txt),%r) { did -a reasons 1 $read($+($prodir,reasons.txt),%r) | inc %r } }
n439=
n440=dialog awaysetup {
n441=  title "Away Settings [/awaysetup]"
n442=  size -1 -1 311 235
n443=  option pixels
n444=  icon system\images\away.ico, 0
n445=  tab "Main", 1, 5 5 300 194
n446=  check "Enable Pager (/ctcp page)", 13, 81 48 153 20, tab 1
n447=  check "DeOp and Voice in Channels", 14, 81 92 161 20, tab 1
n448=  check "Reject DCC Chats", 10, 81 114 117 20, tab 1
n449=  check "Enable Back on Input", 12, 81 136 139 20, tab 1
n450=  icon 167, 25 44 32 32,  system\images\away.ico, 0, tab 1
n451=  check "Auto-Reply Away Message", 11, 81 158 156 19, tab 1
n452=  check "Enable Global Away", 30, 81 71 138 17, tab 1
n453=  tab "Advanced", 152
n454=  check "Auto Away after:", 6, 18 37 100 20, tab 152
n455=  edit "", 7, 145 36 40 22, tab 152 autohs
n456=  edit "", 16, 145 60 40 22, tab 152 autohs
n457=  check "Away Nick:", 8, 18 137 100 20, tab 152
n458=  edit "", 9, 145 136 140 22, tab 152 autohs
n459=  text "minutes", 169, 200 40 59 16, tab 152
n460=  text "seconds", 170, 200 63 59 16, tab 152
n461=  check "Ignore for:", 15, 18 62 100 20, tab 152
n462=  button "Pager", 20, 116 165 55 22, tab 152
n463=  button "Reasons", 21, 170 165 55 22, tab 152
n464=  text "Extra Options:", 19, 18 168 83 16, tab 152
n465=  button "Password", 22, 224 165 55 22, tab 152
n466=  check "Pager Sound:", 23, 18 112 100 20, tab 152
n467=  edit "", 24, 145 111 118 22, tab 152 autohs
n468=  button "?", 25, 264 112 19 19, tab 152
n469=  check "Away message", 4, 18 87 119 20, tab 152
n470=  edit "", 5, 145 85 40 22, tab 152 autohs
n471=  text "minutes", 168, 200 88 59 16, tab 152
n472=  tab "Messages", 2
n473=  edit "", 53, 95 59 195 22, tab 2,autohs
n474=  text "Away Message", 52, 18 63 73 16, tab 2
n475=  combo 54, 18 82 66 58, tab 2 size drop
n476=  button "", 55, 96 85 190 35, tab 2
n477=  check "Enable Custom Away Messages", 50, 18 37 224 20, tab 2
n478=  combo 58, 18 149 66 58, tab 2 size drop
n479=  text "Back Message", 56, 18 130 73 16, tab 2
n480=  button "", 59, 97 152 190 35, tab 2
n481=  edit "", 57, 95 127 195 22, tab 2, autohs
n482=  button "<vars>", 51, 242 35 46 20, tab 2, hide
n483=  tab "Chans", 3
n484=  list 70, 12 33 287 133, tab 3 size
n485=  check "Enable Away Messaging to all channels", 71, 18 172 234 17, tab 3
n486=  button "Ok", 17, 6 203 75 25, ok
n487=  button "Cancel", 18, 89 203 75 25, cancel
n488=  text $name, 99, 218 206 45 16
n489=}
n490=
n491=
n492=
n493=alias awaysetup { $wdialog(awaysetup) }
n494=on *:dialog:awaysetup:init:0: {
n495=  did -a $dname 54,58 /msg | did -a $dname 54,58 /describe
n496=  balloon Away Status > Currently: $iif($away,Away,Here) $crlf $+ Auto-away: $rcon(away,autoint) $crlf $+ Silent Away: $iif($rcon(away,msg) == on,Off,On)
n497=  mdx.fonts $dname 1,13,14,10,12,11,99,17,18,4,5,6,7,8,9,168,169,170,152,15,16,19,20,21,22,30,23,24,25,70,71, $+ $count.id(50,59)
n498=  mdx.buttons $dname 17,18,51,25
n499=  If ($rcon(away,msg) == on) && ($rcon(away,int) != $null) { did -c $dname 4 | did -a $dname 5 $rcon(away,int) }
n500=  elseif ($rcon(away,msg) == on) && ($rcon(away,int) == $null) { $wcon(away,msg,off) } 
n501=  If ($rcon(away,msg) == off) { did -u $dname 4 | did -m $dname 5 | did -ra $dname 5 $rcon(away,int) }
n502=  If ($rcon(away,auto) == on) && ($rcon(away,autoint) != $null) { did -c $dname 6 | did -a $dname 7 $rcon(away,autoint) }
n503=  elseif ($rcon(away,auto) == on) && ($rcon(away,autoint) == $null) { $wcon(away,auto,off) } 
n504=  If ($rcon(away,auto) == off) { did -u $dname 6 | did -m $dname 7 | did -ra $dname 7 $rcon(away,autoint) }
n505=  If ($rcon(away,cnick) == on) && ($rcon(away,nick)) { did -c $dname 8 | did -a $dname 9 $rcon(away,nick) }
n506=  elseif ($rcon(away,cnick) == on) && ($rcon(away,nick) == $null) { $wcon(away,cnick,off) } 
n507=  If ($rcon(away,cnick) == off) { did -u $dname 8 | did -mra $dname 9 $rcon(away,nick) }
n508=  If ($rcon(away,ignore) == on) && ($rcon(away,ignoret)) { did -c $dname 15 | did -a $dname 16 $rcon(away,ignoret) }
n509=  elseif ($rcon(away,ignore) == on) && ($rcon(away,ignoret) == $null) { $wcon(away,ignore,off) } 
n510=  If ($rcon(away,ignore) == off) { did -u $dname 15 | did -mra $dname 16 $rcon(away,ignoret) }
n511=  If ($rcon(away,dccrj) == on) { did -c $dname 10 }
n512=  If ($rcon(away,Reply) == on) { did -c $dname 11 }
n513=  If ($rcon(away,boi) == on) { did -c $dname 12 }
n514=  If ($rcon(away,pager) == on) { did -c $dname 13 }
n515=  If ($rcon(away,doav) == on) { did -c $dname 14 }
n516=
n517=  if ($rcon(away,msg.custom) == on) { did -c $dname 50 }
n518=
n519=  if ($rcon(away,msg.awaym) == /msg) { did -c $dname 54 1 }  | else { did -c $dname 54 2 } 
n520=
n521=  if (!$rcon(away,msg.away)) { $wcon(away,msg.away,be back later (<reason>) }
n522=  if (!$rcon(away,msg.back)) { $wcon(away,msg.back, i am back  (<time>) }
n523=  did -ra $dname 53 $rcon(away,msg.away)
n524=  did -ra $dname 57 $rcon(away,msg.back)
n525=
n526=
n527=  window -h @awaymsgad
n528=  mdx SetControlMDX $dname 55 window > $mddlg
n529=  did -a $dname 55 grab $window(@awaymsgad).hwnd @awaymsgad
n530=
n531=  window -h @backmsgad
n532=  mdx SetControlMDX $dname 59 window > $mddlg
n533=  did -a $dname 59 grab $window(@backmsgad).hwnd @backmsgad
n534=
n535=  aline -p @awaymsgad $away.msgrep($rcon(away,msg.away))
n536=  aline -p @backmsgad $away.msgrep($rcon(away,msg.back))
n537=
n538=  if (*msg* iswm $rcon(away,msg.backm)) { did -c $dname 58 1 } | else { did -c $dname 58 2 } 
n539=
n540=  if ($rcon(away,global) == on) { did -c $dname 30 }
n541=
n542=  if (!$isfile($rcon(away,pager.sf))) { $wcon(away,pager.sf,...) | $wcon(away,pager.snd,off) }
n543=  if ($rcon(away,pager.snd) == on) { did -c $dname 23 }
n544=
n545=
n546=  did -ra $dname 24 $rcon(away,pager.sf)
n547=  if ($rcon(away,msg.allchan) == on) { did -c $dname 71 }
n548=  mdx SetControlMDX $dname 70 listview icon smallicons rowselect showsel single labeltip $rcon(display,list.style) > $views 
n549=  did -i $dname 70 1 headerdims 75:1 222:2
n550=  did -i $dname 70 1 headertext Server $chr(9) Channels
n551=  did -i $dname 70 1 seticon list 0 system\images\server.ico
n552=
n553=  away.loadchan
n554=
n555=
n556=}
n557=
n558=on *:dialog:awaysetup:edit:*: {
n559=  if ($did == 5) && ($did(5) isnum) && ($did(5) != $null) { $wcon(away,int,$did(5)) | did -ra $dname 5 $rcon(away,int) }
n560=  if ($did == 7) && ($did(7) isnum) && ($did(7) != $null) { $wcon(away,autoint,$did(7)) | .timerAutoaway 1 $calc($rcon(away,autoint) * 60) away.auto }
n561=  if ($did == 16) && ($did(16) isnum) && ($did(16) != $null) { $wcon(away,ignoret,$did(16)) | did -ra $dname 16 $rcon(away,ignoret) }
n562=  if ($did == 9) && ($did(9) != $null)  { $wcon(away,nick,$did(9)) } 
n563=  if ($did == 53)  && ($did(53)) { $wcon(away,msg.away,$did(53)) |     clear @awaymsgad |   aline -p @awaymsgad $away.msgrep($did(53))  } 
n564=  if ($did == 57) && ($did(57)) { $wcon(away,msg.back,$did(57)) |  clear @backmsgad |   aline -p @backmsgad $away.msgrep($did(57)) }
n565=  if ($did == 24) { $wcon(away,pager.sf,$did(24)) }
n566=}
n567=alias away.chanpopc {
n568=  var %d = $+($prodir,opt.ini)
n569=  var %txt = $rcon(away:chans,$2)
n570=  if ($1 == edit) { var %x = $$?="Edit Channels for $2 " | if (%x) { writeini %d away:chans $2 %x | away.loadchan } }
n571=  if ($1 == add) {  var %s = $$?="Network name:" | var %c = $$?="Channels $crlf i.e.  #help,#art,#windows" | if (%s) && (%c) { $wcon(away:chans,%s,%c) | away.loadchan } }
n572=  if ($1 == rem) { var %a = $$?!="Delete $2 ?" | if (%a) { remini $+($prodir,opt.ini) away:chans $2 | away.loadchan } }
n573=
n574=}
n575=alias away.loadchan {
n576=  did -r awaysetup 70 | var %a = 1
n577=  while ($ini($+($prodir,opt.ini),away:chans,%a)) { var %n = $ini($+($prodir,opt.ini),away:chans,%a) | did -a awaysetup 70 0 1 %n $chr(9) $rcon(away:chans,%n) | inc %a }
n578=}
n579=on *:dialog:awaysetup:sclick:*:{
n580=  if ($did == 70) {
n581=
n582=
n583=    var %n = $right($gettok($did($dname,70).seltext,1,9),-11)
n584=    if (rclick != $gettok($did($dname,70,1),1,32)) halt
n585=    popups New away.chans 12 16
n586=    pop.item away.chans $iif(!%n,+d)  Edit $cr away.chanpopc edit %n
n587=    pop.item away.chans
n588=    pop.item away.chans Add Network $cr away.chanpopc add
n589=    pop.item away.chans Rem Network $cr away.chanpopc rem %n
n590=    popit away.chans $mouse.dx $mouse.dy
n591=
n592=
n593=  }
n594=  if ($did == 4) { if ($did($dname,4).state == 1) { did -n $dname 5 | $wcon(away,msg,on) } | else { $wcon(away,msg,off) | did -m $dname 5 } }
n595=  if ($did == 6) { if ($did($dname,6).state == 1) { did -n $dname 7 | $wcon(away,auto,on) } | else { $wcon(away,auto,off) | did -m $dname 7 | /.timerAutoaway off } }
n596=  if ($did == 8) { if ($did($dname,8).state == 1) { did -n $dname 9 | $wcon(away,cnick,on) } | else { $wcon(away,cnick,off) | did -m $dname 9 } }
n597=  if ($did == 15) { if ($did($dname,15).state == 1) { did -n $dname 16 | $wcon(away,ignore,on) } | else { $wcon(away,ignore,off) | did -m $dname 16 } }
n598=  if ($did == 10) { if ($did($dname,10).state == 1) { $wcon(away,dccrj,on) } | else { $wcon(away,dccrj,off) } }
n599=  if ($did == 11) { if ($did($dname,11).state == 1) { $wcon(away,reply,on) } | else { $wcon(away,reply,off) } }
n600=  if ($did == 12) { if ($did($dname,12).state == 1) { $wcon(away,boi,on) } | else { $wcon(away,boi,off) } }
n601=  if ($did == 13) { if ($did($dname,13).state == 1) { $wcon(away,pager,on) } | else { $wcon(away,pager,off) } }
n602=  if ($did == 14) { if ($did($dname,14).state == 1) { $wcon(away,doav,on) } | else { $wcon(away,doav,off) } }
n603=  if ($did == 17) {
n604=    if ($did($dname,4).state == 1) && ($did(5) != $null) && ($did(5) isnum) { $wcon(away,msg,on) | $wcon(away,autoint,$did(5)) }
n605=    elseif ($did($dname,4).state == 1) && ($did(5) == $null) { derror Error The Ad interval was not set. The Feature was turned off. | $wcon(away,msg,off) }
n606=    elseif ($did($dname,5).text !isnum) && ($did($dname,4).state == 1) { derror Error The Ad interval is not a valid Number. The Feature was turned off. | $wcon(away,msg,off) }
n607=    elseif ($did($dname,4).state == 0) { $wcon(away,msg,off) | $wcon(away,int,$did(5)) }
n608=    if ($did($dname,6).state == 1) && ($did($dname,7).text != $null) && ($did($dname,7).text isnum) { $wcon(away,auto,on) | $wcon(away,autoint,$did(7)) | /.timerAutoaway 1 $calc($rcon(away,autoint) * 60) away.auto }
n609=    elseif ($did($dname,6).state == 1) && ($did($dname,7).text == $null) { derror Error The Auto Away ad interval was not set. The Feature was turned off. | $wcon(away,auto,off) }
n610=    elseif ($did($dname,7).text !isnum) && ($did($dname,6).state == 1) { derror Error The Auto Away Ad interval is not a Number. The Feature was turned off. | $wcon(away,auto,off)  }
n611=    elseif ($did($dname,6).state == 0) { $wcon(away,auto,off) | $wcon(away,autoint,$did(7)) | .timerAutoaway off }
n612=    if ($did($dname,8).state == 1) && ($did($dname,9).text != $null) { $wcon(away,cnick,on) | $wcon(away,nick,$did(9)) }
n613=    elseif ($did($dname,8).state == 1) && ($did($dname,9).text == $null) { derror Error Please set the Away Nick. The Feature was turned off. | $wcon(away,cnick,off) }
n614=    elseif ($did($dname,8).state == 0) { $wcon(away,cnick,off) | $wcon(away,nick,$did(9)) }
n615=    if ($did($dname,15).state == 1) && ($did(16) != $null) && ($did(16) isnum) { $wcon(away,ignore,on) | $wcon(away,ignoret,$did(16)) }
n616=    elseif ($did($dname,15).state == 1) && ($did(16) == $null) { derror Error The Ignore time was not set. The Feature was turned off. | $wcon(away,ignore,off) }
n617=    elseif ($did($dname,16).text !isnum) && ($did($dname,15).state == 1) { derror Error The Ignore time is not a valid Number. The Feature was turned off. | $wcon(away,ignore,off) }
n618=    elseif ($did($dname,15).state == 0) { $wcon(away,ignore,off) | $wcon(away,ignoret,$did(16)) }
n619=  }
n620=  if ($did == 20) { pager }
n621=  if ($did == 21) { setaway2 }
n622=  if ($did == 22) { away.pass }
n623=
n624=  if ($did == 25) { var %ps = $sfile(system\,Choose a Pager Sound, Okay) | if (%ps) { did -ra $dname 24 %ps | $wcon(away,pager.sf,$did(24)) } }
n625=
n626=  if ($did == 30) { $wcon(away,global,$iif($did($dname,$did).state == 1,on,off)) }
n627=  if ($did == 23) { $wcon(away,pager.snd,$iif($did($dname,$did).state == 1,on,off)) }
n628=  if ($did == 50) { $wcon(away,msg.custom,$iif($did($dname,$did).state == 1,on,off)) }
n629=
n630=  if ($did == 54) { $wcon(away,msg.awaym,$did(54)) }
n631=  if ($did == 58) { $wcon(away,msg.backm,$did(58)) }
n632=
n633=  if ($did == 71)  { $wcon(away,msg.allchan,$iif($did($dname,$did).state == 1,on,off)) }
n634=
n635=
n636=
n637=}
n638=
n639=
n640=;;;PASS PROT
n641=
n642=alias away.pass { $wdialog(awaypass) }
n643=dialog awaypass {
n644=  title "Away Password Protection"
n645=  size -1 -1 225 126
n646=  icon system\images\away.ico, 0
n647=  box "", 1, 5 -1 215 121
n648=  icon 2, 16 18 32 32,  system\images\away.ico, 0
n649=  text "Password:", 3, 14 72 49 16
n650=  edit "", 4, 68 68 140 22, autohs
n651=  button "Clear", 10, 157 92 50 20
n652=  check "Enable", 8, 69 93 69 17
n653=  text "Users will be prompted with a password upon returning from away mode.", 5, 55 18 156 48
n654=  button "ok", 6, 19 94 11 11, ok hide
n655=}
n656=on *:dialog:awaypass:init:0:{
n657=  mdx.fonts $dname 1,3,4,5,8,10,6,7,8
n658=  mdx.buttons $dname 10,6,7
n659=  if ($rcon(away,away.pass2) != $null) { 
n660=    set %pass.temp $?="Enter a Password?"
n661=    if (%pass.temp === $rcon(away,away.pass2)) { 
n662=      mdx.fonts $dname 1,3,4,5,8,10,6,7,8
n663=      mdx.buttons $dname 10,6,7
n664=      did -a $dname 4 $rcon(away,away.pass2)
n665=      if ($rcon(Password,startup) == true) { did -c $dname 5 } | else { did -u $dname 5 }
n666=      if ($rcon(Password,away) == true) { did -c $dname 8 } | else { did -u $dname 8 }
n667=      unset %pass.temp
n668=      return 
n669=    }
n670=    elseif (%pass.temp === $null) { dialog -x awaypass awaypass }
n671=    elseif (%pass.temp != $rcon(away,away.pass2)) {
n672=      dialog -x awaypass awaypass
n673=      derror Error Invalid Password
n674=    }
n675=  }
n676=  else { 
n677=    mdx.fonts $dname 1,3,4,5,8,10,6,7,8
n678=    mdx.buttons $dname 10,6,7
n679=    did -a $dname 4 $rcon(away,away.pass2)
n680=    if ($rcon(Password,startup) == true) { did -c $dname 5 } | else { did -u $dname 5 }
n681=    if ($rcon(Password,exit) == true) { did -c $dname 8 } | else { did -u $dname 8 }
n682=  }
n683=}
n684=on *:dialog:awaypass:sclick:*:{
n685=  if ($did == 8) { if ($did($dname,8).state == 1) { $wcon(away,away.pass,true) } | else { $wcon(away,away.pass,false) } }
n686=  if ($did == 10) { remini $+($prodir,opt.ini) away away.pass2 | did -r $dname 4 }
n687=}
n688=on *:dialog:awaypass:edit:4:{
n689=  $wcon(away,away.pass2,$did(4))
n690=}
n691=
n692=
n693=;-------------------
n694=;############ ;############
n695=;############ ;############
n696=;#####                 ;#####
n697=;##########     ;############    F I L E S E R V I N G     S Y S T EM S   
n698=;##########     ;############
n699=;#####                                  #####                 fserv, tdcc, xdcc, ftp
n700=;#####                 ;############
n701=;#####                 ;############                                      -Nalika
n702=
n703=;did -a $dname 6 +cg 2 Transfers $+ $chr(9) $+ Transfers $+ $chr(9) $+ show.stat 7 2 8 9
n704=
n705=;-----------
n706=
n707=alias fs.msg {
n708=  var %a = 1
n709=  while ($scon(%a)) { 
n710=    scon %a
n711=    if (!$server) { inc %a | continue }
n712=    var %b = 1
n713=    while ($gettok($rcon(fserv:chans,$network),%b,44)) { 
n714=      msg $gettok($rcon(fserv:chans,$network),%b,44) $fs(ad) 
n715=      inc %b 
n716=    }
n717=    inc %a
n718=  }
n719=
n720=}
n721=
n722=alias fs { 
n723=  if ($1 == ad) { 
n724=    var %a = 1
n725=    while ($ini($+($prodir,opt.ini),fserv:trigs,%a)) {
n726=      var %n = $ini($+($prodir,opt.ini),fserv:trigs,%a), %t = $rcon(fserv:trigs,%n)
n727=      if ($gettok(%t,1,169) == on) {  var %trg = $iif(%trg,%trg) %n | inc %a }
n728=      else { inc %a }
n729=    }
n730=    if ($2 == trign) { return $numtok(%trg,32) }
n731=    else return $brac(Fileservers Online)  $fm(Triggers,%trg) $fm(Online,$+($fserv(0),/,$rcon(fserv,fs.mxusers))) $fm(Sends,$+($send(0),/,$rcon(fserv,fs.mxSt))) $fm(Queues,$+($queue(0),/,$rcon(fserv,fs.mxQt))) $fm(Accessed,$+($rcon(fserv,fs.access),$chr(32),times))) $fm(Note,$rcon(fserv,fs.note)) $l
n732=  }
n733=  if ($1 == qc) { queue.send | return }
n734=  var %banfile = $+($prodir,fs_bans.txt)
n735=  if ($1 == banN) { return $lines(%banfile) }
n736=  if ($1 == isban) && ($2) { 
n737=    var %l = 1
n738=    while ($read(%banfile,%l)) {
n739=      var %test = $eval($gettok($v1,1,9),10)
n740=      if (%test iswm $2) { return true }
n741=      else { inc %l }
n742=    }
n743=    return false
n744=  }
n745=  if ($1 == sends) && ($2) { var %a = 1,%b = 0 | while ($send(%a)) { $iif($send(%a) == $2,inc %b) | inc %a } | return %b }
n746=
n747=  if ($1 == exists) { ;nick net file
n748=    ; echo aaaa $2 //// $3 /// $4
n749=    var %a = 1
n750=    while ($read($+($prodir,queue.txt),%a)) { 
n751=      var %b = $read($+($prodir,queue.txt),%a) | if ($gettok(%b,1,32) == $2) && ($gettok(%b,2,32) == $3) && ($gettok(%b,3,32) == $4) { var %qc = yes } 
n752=      inc %a 
n753=    }
n754=    if (%qc == yes) { return $true } | else return $false
n755=  }
n756=
n757=  if ($1 == queues) && ($2) && ($3) { ;nick net
n758=    var %a = 1,%b = 0 | 
n759=    while ($read($+($prodir,queue.txt),%a)) { 
n760=      var %t = $v1
n761=      if ( ($gettok(%t,1,32) == $2) && ($gettok(%t,2,32) == $3) )  { inc %b }
n762=
n763=      inc %a 
n764=    }
n765=    return %b 
n766=  }
n767=
n768=  else $wdialog(fs)
n769=}
n770=alias fsad {
n771=  if ($1 == help) { echo help> fs ad options. /fs <start|stop | [#chan] > }
n772=  if (($1 == start) || ($1 == on)) { fs.msg | .timerFILESERV 0 $calc($rcon(fserv,fs.int) * 60) fs.msg | return }
n773=  if (($1 == stop) || ($1 == off)) { .timerFILESERV off | return }
n774=  if ($me ison $1) { msg $1 $fs(ad) | return } 
n775=  else say $fs(ad)
n776=}
n777=alias queue { if ($isid)  { return $iif($1 == 0,$lines($+($prodir,queue.txt)),$read($+($prodir,queue.txt),$1)) }  | else { if ($1) && ($2) && ($3) && (!$fs(exists,$1,$2,$3)) { write $+($prodir,queue.txt) $1 $2 $3- | $iif($dialog(fs),load.queues) } } }
n778=alias queue.send { 
n779=  var %q = 0
n780=  :start
n781=  inc %q
n782=  if (%q > $queue(0)) { return  }
n783=  if ($queue(0) > 0) && ($rcon(fserv,fs.mxSt) > $send(0)) {
n784=    if ($rcon(fserv,fs.mxSu) > $fs(sends,$gettok($queue(%q),1,32))) { goto send }
n785=    else { goto start }
n786=  }
n787=  goto start
n788=  :send 
n789=  var %n = $gettok($queue(%q),2,32), %i = 0
n790=  while ($scon(%i)) {
n791=    if ( ($scon(%i).network == %n) && (%n) ) {   scon %i  dcc send $gettok($queue(%q),1,32) " $+ $gettok($queue(%q),3-,32) $+ " | write $+(-dl,%q) $+($prodir,queue.txt) | $iif($dialog(fs),load.queues) }
n792=    inc %i
n793=  }
n794=
n795=}
n796=
n797=on *:text:*:#:{
n798=  if ($1- == !list) && ($rcon(fserv,fs.list) == on) && ($rcon(fserv:chans,$network)) && ($istok($rcon(fserv:chans,$network),#,44) ) { .notice $nick $fs(ad) }
n799=  if ($1- == !list) && ($rcon(xdcc,listr) == on) && ($rcon(xdcc:chans,$network)) && ($istok($rcon(xdcc:chans,$network),#,44))  { .notice $nick $xdcc(ad) }
n800=  elseif ($1 == !list) && ($rcon(xdcc,serveall) == on) &&  ($rcon(xdcc,listr) == on)  { .notice $nick $xdcc(ad) }
n801=
n802=  var %n = $ini($+($prodir,opt.ini),fserv:trigs,%a)
n803=  var %t = $rcon(fserv:trigs,$1-)
n804=  if  ($rcon(fserv:trigs,$1-)) && ($gettok(%t,1,169) == on) && ($rcon(fserv:chans,$network)) && ($istok($rcon(fserv:chans,$network),$chan,44) )  {
n805=    if ($fserv(0) < $rcon(fserv,fs.mxusers)) && ($fs(isban,$fulladdress) != true) && ($exists($+(",$gettok(%t,2,169),"))) {
n806=      fserve $nick $rcon(fserv,fs.mxSu) $+(",$gettok(%t,2,169),") $iif($isfile($gettok(%t,3,169)),$gettok(%t,3,169),$+($prodir,fserv.txt)) | $wcon(fserv,fs.access,$calc($rcon(fserv,fs.access) + 1 )) | halt 
n807=    } 
n808=    else { .notice $nick Sorry, the FileServer is currently full. Please try again later. $l $auth(web) | return }
n809=  }
n810=  if ($rcon(fserv:chans,$network)) && ($istok($rcon(fserv:chans,$network),$chan,44) ) {
n811=    var %tdcc = 1 | while (%tdcc <= 5) { if ($1- == $rcon(tdcc,$+(%tdcc,.trig)))   { $wcon(tdcc,$+(%tdcc,.dl),$calc($rcon(tdcc,$+(%tdcc,.dl)) + 1)) | fs.send $nick $cid $scid($cid).network $+(tdcc,$chr(169),%tdcc) | return } | inc %tdcc }
n812=  }
n813=}
n814=
n815=alias tdcc.ad { return $brac(TDCC Online) $fm(Trigger,$rcon(tdcc,$+($1,.trig))) $fm(Description,$rcon(tdcc,$+($1,.note))) $fm(Size,$bytes($file($rcon(tdcc,$+($1,.file))).size).suf) $fm(Sends,$+($send(0),/,$rcon(fserv,fs.mxSt))) $fm(Queues,$+($queue(0),/,$rcon(fserv,fs.mxQt))) $fm(Downloads,$rcon(tdcc,$+($1,.dl))) $l }
n816=alias tdcc {
n817=  if ($1 == start) && ($2 isnum 1-5) { allmsg $rcon(tdcc,$+($2,.chan)) $tdcc.ad($2) | .timerTDCC $+ $2 0 $calc($rcon(tdcc,$+($2,.int)) * 60) allmsg $rcon(tdcc,$+($2,.chan)) $tdcc.ad($2)  }
n818=  if ($1 == stop) && ($2 isnum 1-5) { .timerTDCC $+ $2 off }
n819=  if ($1 == say) && ($2 isnum 1-5) { say $tdcc.ad($2) }
n820=
n821=
n822=}
n823=alias fs.send {
n824=  ;nick cid network file
n825=  var %t = $gettok($4,2,169)
n826=
n827=  if ($gettok($4,1,169) == tdcc) && (  $isfile($rcon(tdcc,$+(%t,.file))) ) {  var %msg = .notice $1, %f = $rcon(tdcc,$+(%t,.file))   }
n828=  elseif ($isfile($4)) {    var %msg = msg $+(=,$1), %f = $4-  }
n829=
n830=
n831=  if ($send(0) >= $rcon(fserv,fs.mxSt)) {
n832=    if ($queue(0) >= $rcon(fserv,fs.mxQt))  { scid $2 %msg Sorry, there are too many sends in progress and all the queue slots are in use. For more info type sends }
n833=    elseif ($fs(queues,$1,$3) >= $rcon(fserv,fs.mxQu)) { scid $2 %msg Sorry there are too many sends in progress and you have used all of your queue slots. }
n834=    else {
n835=      if ($fs(exists,$1,$3,%f) == $false) {
n836=        queue $1 $3 %f
n837=        scid $2 %msg Queuing $nopath(%f) $+($chr(91),$bytes($file(%f).size).suf,$chr(93)) It has been placed in Queue Slot $queue(0)
n838=      }
n839=      else scid $2 %msg Error: You are queuing a file that you have already queued
n840=    }
n841=  }
n842=  elseif ($fs(sends,$nick) >= $rcon(fserv,fs.mxSu)) {
n843=    if ($queue(0) >= $rcon(fserv,fs.mxQt)) { scid $2 %msg Sorry, you have too many transfers right now and all the queue slots are in use }
n844=    elseif ($fs(queues,$1,$3) >= $rcon(fserv,fs.mxQu)) { scid $2 %msg Sorry, you have too many transfers right now and you have used all your queue slots.  If you still want to get a file please wait for one to finish and try again. }
n845=    else {
n846=      if ($fs(exists,$1,$3,%f) == $false) {
n847=        queue $1 $3 %f
n848=        scid $2 %msg Queuing $nopath(%f) $+($chr(91),$bytes($file(%f).size).suf,$chr(93)) It has been placed in Queue Slot $queue(0)
n849=      }
n850=      else scid $2 %msg Error: You are queuing a file you have queued
n851=    }
n852=  }
n853=  else { scid $2 dcc send $1 $+(",%f,") | scid $2 %msg Sending $nopath(%f) $+($chr(91),$bytes($file(%f).size).suf,$chr(93)) | halt  }
n854=
n855=
n856=}
n857=
n858=
n859=on *:serv:get *:{
n860=  var %f = $+($fserv($target).cd,\,$2-)
n861=  if (!$2) { scid $cid msg =$nick Invalid Command. /get <filename> | return  }
n862=  if (!$isfile(%f)) { scid $cid msg =$nick Invalid Filename | return }
n863=
n864=  fs.send $nick $cid $scid($cid).network  %f
n865=
n866=}
n867=
n868=
n869=;#############
n870=;#############
n871=
n872=;;;XDCC a/r
n873=
n874=;##############
n875=;##############
n876=
n877=alias xdcc.msg {
n878=  if ($rcon(xdcc,adv) == on) {
n879=    var %a = 1
n880=
n881=    while ($scon(%a)) { 
n882=      scon %a
n883=      if (!$server) { inc %a | continue }
n884=      if ($rcon(xdcc,serveall) == on) {  var %c = 1 |  while (%c <= $chan(0)) { msg $chan(%c) $xdcc(ad) | inc %c }   }
n885=      else {
n886=        var %b = 1
n887=        while ($gettok($rcon(xdcc:chans,$network),%b,44)) { 
n888=          if ($me ison $gettok($rcon(xdcc:chans,$network),%b,44))  msg $gettok($rcon(xdcc:chans,$network),%b,44) $xdcc(ad) 
n889=          inc %b 
n890=        }
n891=
n892=
n893=      }
n894=      inc %a
n895=    }
n896=  }
n897=}
n898=
n899=alias xdccad {
n900=  if ($1 == help) { echo help> xdcc ad options. /xdcc <start|stop | [#chan] > }
n901=  if (($1 == start) || ($1 == on)) { $wcon(xdcc,adv,on) | xdcc.msg | .timerXDCCAD 0 $calc($rcon(xdcc,adv.t) * 60) xdcc.msg | return }
n902=  if (($1 == stop) || ($1 == off)) { $wcon(xdcc,adv,off) | .timerXDCCAD off | return }
n903=  if ($me ison $1) { msg $1 $xdcc(ad) | return } 
n904=  else say $xdcc(ad)
n905=}
n906=
n907=alias xdcc {
n908=  var %f = $+($prodir,xdcc.txt)
n909=  if (numpack* iswm $1) { return $lines(%f) }
n910=  if (($1 isnum) && ($2 == file)) {   return $gettok($read(%f,$1),1,169) }
n911=  if (($1 isnum) && ($2 == desc)) {     return $gettok($read(%f,$1),2,169) } 
n912=  if ($1 ==  qc)  { $queue.x.send }
n913=
n914=  if ($1 == sends) && ($2) { var %a = 1,%b = 0 | while ($send(%a)) { $iif($send(%a) == $2,inc %b) | inc %a } | return %b }
n915=
n916=  if ($1 == ad) { return $brac(XDCC Online)  $fm( get the Packet List,$rcon(xdcc,reqmeth) $me xdcc list)  $fm(Sends,$+($send(0),/,$rcon(xdcc,sendtotal))) $fm(Queues,$+($queue.x(0),/,$rcon(xdcc,qtotal)))  $l }
n917=
n918=
n919=  if ($1 == exists) { ;nick net file
n920=    ; echo aaaa $2 //// $3 /// $4
n921=    var %a = 1
n922=    while ($read($+($prodir,queue_x.txt),%a)) { 
n923=      var %b = $read($+($prodir,queue_x.txt),%a) | if ($gettok(%b,1,32) == $2) && ($gettok(%b,2,32) == $3) && ($gettok(%b,3,32) == $4) { var %qc = yes } 
n924=      inc %a 
n925=    }
n926=    if (%qc == yes) { return $true } | else return $false
n927=  }
n928=
n929=  if ($1 == queues) && ($2) && ($3) { 
n930=    var %a = 1,%b = 0 | 
n931=    while ($read($+($prodir,queue_x.txt),%a)) { 
n932=      var %t = $v1
n933=      if ( ($gettok(%t,1,32) == $2) && ($gettok(%t,2,32) == $3) )  { inc %b }
n934=
n935=      inc %a 
n936=    }
n937=    return %b 
n938=  }
n939=
n940=
n941=
n942=}
n943=
n944=
n945=alias xdcc.makelist {
n946=  var %plist = $+($prodir,xdcc_list.txt), %a = 1, %f = $+($prodir,xdcc.txt)
n947=
n948=  write -c %plist XDCC SERVER LIST $crlf $str(-,30) $crlf To get a file, $rcon(xdcc,reqmeth) $me xdcc send <number> $crlf $crlf $crlf $crlf
n949=
n950=  while (%a <= $lines(%f)) {
n951=    write %plist $+(%a,$chr(41)) $chr(9) File: $nopath($xdcc(%a,file))
n952=    write %plist $chr(9) Size: $bytes($file($xdcc(%a,file)).size).suf
n953=    write %plist $chr(9) >>>>: $xdcc(%a,desc)) $crlf $crlf | inc %a
n954=  }
n955=}
n956=alias xdcc.send {
n957=  if ($4 == list) { var %nick = $1, %c = $2, %net = $3, %x = 0, %f = $+($prodir,xdcc_list.txt) }
n958=
n959=  elseif ($4 isnum) {
n960=    var %nick = $1, %c = $2, %net = $3, %x = $4, %f = $xdcc(%x,file), %packlist = $+($prodir,xdcc_list.txt)
n961=    if ((%x > $xdcc(numpacks)) || (!$isfile(%f))) { scid %c .notice %nick error: no such packet or file exists. try another | return  }
n962=
n963=  }
n964=  else { return }
n965=  ;; if (%x == list) && ($xdcc(listsend,%nick) != true) { scid %c dcc send %nick $+(",%packlist,") | return }
n966=
n967=  ;; send the file
n968=
n969=  if ($send(0) >= $rcon(xdcc,sendtotal)) {
n970=    if ($queue.x(0) >= $rcon(xdcc,qtotal))  { scid %c .notice %nick Sorry, there are too many sends in progress and all the queue slots are in use }
n971=    elseif ($xdcc(queues,%nick,%net) >= $rcon(xdcc,quser)) { scid %c .notice %nick Sorry there are too many sends in progress and you have used all of your queue slots. }
n972=    else {
n973=      if ($xdcc(exists,%nick,%net,%f) == $false) {
n974=        queue.x %nick %net %f
n975=        scid %c .notice %nick Queuing $nopath(%f) $+($chr(91),$bytes($file(%f).size).suf,$chr(93)) It has been placed in Queue Slot $queue.x(0)
n976=      }
n977=      else scid %c .notice %nick Error: You are queuing a file that you have already queued
n978=    }
n979=  }
n980=  elseif ($xdcc(sends,%nick) >= $rcon(xdcc,senduser)) {
n981=    if ($queue.x(0) >= $rcon(xdcc,qtotal)) { scid %c .notice %nick Sorry, you have too many transfers right now and all the queue slots are in use }
n982=    elseif ($xdcc(queues,%nick,%net) >= $rcon(xdcc,quser)) { scid %c .notice %nick Sorry, you have too many transfers right now and you have used all your queue slots.  If you still want to get a file please wait for one to finish and try again. }
n983=    else {
n984=      if ($xdcc(exists,%nick,%net,%f) == $false) {
n985=        queue.x %nick %net %f
n986=        scid %c .notice %nick Queuing $nopath(%f) $+($chr(91),$bytes($file(%f).size).suf,$chr(93)) It has been placed in Queue Slot $queue.x(0) [Lika]
n987=      }
n988=      else scid %c .notice %nick Error: You are queuing a file you have queued AAA
n989=    }
n990=  }
n991=  else { scid %c dcc send $nick " $+ %f $+ " | scid %c .notice %nick Sending $nopath(%f) $+($chr(91),$bytes($file(%f).size).suf,$chr(93)) | halt  }
n992=
n993=
n994=  ;;; end://sendfile
n995=
n996=}
n997=
n998=
n999=on *:text:*:?:{
n1000=  if (($rcon(xdcc,status) == on) && ($rcon(xdcc,reqmeth) == /msg) && (xdcc list* iswm $1-)  && ($fs(isban,$fulladdress) != true) ) { xdcc.send  $nick $cid $scid($cid).network list }
n1001=  if (($rcon(xdcc,status) == on) && ($rcon(xdcc,reqmeth) == /msg) && (xdcc send * iswm $1-)  && ($fs(isban,$fulladdress) != true) ) { xdcc.send  $nick $cid $scid($cid).network $3 }
n1002=}
n1003=
n1004=ctcp *:*:*: { 
n1005=  if (($rcon(xdcc,status) == on) && ($rcon(xdcc,reqmeth) == /ctcp) && (xdcc list* iswm $1-)  && ($fs(isban,$fulladdress) != true)  ) { xdcc.send  $nick $cid $scid($cid).network list }
n1006=  if (($rcon(xdcc,status) == on) && ($rcon(xdcc,reqmeth) == /ctcp) && (xdcc send * iswm $1-)  && ($fs(isban,$fulladdress) != true)  ) { xdcc.send  $nick $cid $scid($cid).network $3 }
n1007=
n1008=}
n1009=
n1010=alias queue.x { if ($isid)  { return $iif($1 == 0,$lines($+($prodir,queue_x.txt)),$read($+($prodir,queue_x.txt),$1)) }  | else { if ($1) && ($2) && ($3) && (!$xdcc(exists,$1,$2,$3)) { write $+($prodir,queue_x.txt) $1 $2 $3- | $iif($dialog(fs),xdcc.loadqueues) } } }
n1011=alias queue.x.send { 
n1012=
n1013=  if ($rcon(xdcc,status) == on) {
n1014=    set %q 0
n1015=    :start
n1016=    inc %q
n1017=    if (%q > $queue.x(0)) { unset %q | return }
n1018=    if ($queue.x(0) > 0) && ($rcon(xdcc,sendtotal) > $send(0)) {
n1019=      if ($rcon(xdcc,senduser) > $xdcc(sends,$gettok($queue.x(%q),1,32))) { goto send }
n1020=      else { goto start }
n1021=    }
n1022=    goto start
n1023=    :send 
n1024=    var %n = $gettok($queue.x(%q),2,32), %i = 1
n1025=
n1026=    ;  echo SEND IT %q
n1027=    while ($scon(%i)) {
n1028=      if ( ($scon(%i).network == %n) && ($scon(%i).server) ) {  scid %i dcc send $gettok($queue.x(%q),1,32) $+(",$gettok($queue.x(%q),3-,32),") | write $+(-dl,%q) $+($prodir,queue_x.txt) | $iif($dialog(fs),xdcc.loadqueues)  }
n1029=      inc %i
n1030=    }
n1031=
n1032=  }
n1033=
n1034=}
n1035=
n1036=
n1037=;;;#######################
n1038=;;;### FSERV SETUP DIALOG###
n1039=;;;#######################
n1040=
n1041=dialog fs {
n1042=  title "File Servers [/fs]"
n1043=  size -1 -1 420 283
n1044=  icon system\images\fs.ico, 0
n1045=  box "", 1, 114 0 301 246
n1046=  list 2, 3 6 107 240, size
n1047=  button "Ok", 3, 257 253 75 25, ok
n1048=  button "Close", 4, 340 253 75 25, cancel
n1049=  list 5, 114 6 301 240, size hide
n1050=  list 6, 114 6 301 240, size hide
n1051=
n1052=  ;--------
n1053=  text "Look for this feature and more coming up in newer versions of $name", 7, 125 208 200 30, hide
n1054=  edit "", 33, 138 31 228 22, hide autohs
n1055=  text "Description:", 32, 125 16 63 16, hide
n1056=  text "User:", 35, 131 79 24 16, hide
n1057=  text "Total:", 37, 131 102 30 16, hide
n1058=  edit "", 36, 165 75 35 22, hide limit 3
n1059=  edit "", 38, 165 97 35 22, hide limit 3
n1060=  box "Max Sends", 34, 124 60 82 65, hide
n1061=  box "Max Queues", 39, 124 129 82 65, hide
n1062=  edit "", 41, 165 143 35 22, hide limit 3
n1063=  edit "", 43, 165 165 35 22, hide limit 3
n1064=  text "User:", 40, 131 147 24 16, hide
n1065=  text "Total:", 42, 131 170 30 16, hide
n1066=  text "Ad Delay:", 44, 221 65 68 17, hide
n1067=  edit "", 45, 297 62 40 22, hide
n1068=  text "Max Users:", 46, 221 88 73 17, hide
n1069=  edit "", 47, 297 85 40 22, hide
n1070=  check "Enable on Start", 48, 221 113 132 17, hide
n1071=  text "mins", 49, 340 68 23 16, hide
n1072=  check "Enable !list respond", 29, 221 131 160 17, hide
n1073=  edit "", 31, 220 156 185 79,  hide multi return autovs vsbar
n1074=  text "Welcome text:", 30, 146 215 75 16, hide
n1075=  ;---------------------------------
n1076=
n1077=  list 200, 114 6 301 240, size 
n1078=
n1079=  ;-------------------------------
n1080=
n1081=
n1082=  text "Select a List:", 226, 148 17 95 16, hide
n1083=  combo 227, 253 14 149 100, hide size drop
n1084=
n1085=  list 225, 114 38 301 208, hide size
n1086=  list 228, 114 38 301 208, hide size
n1087=  list 229, 114 38 301 208, hide size
n1088=
n1089=  ;---------------------
n1090=
n1091=  text "Trigger:", 101, 122 20 50 16, hide
n1092=  edit "", 102, 195 15 85 22, hide
n1093=  text "Ad Delay:", 103, 122 43 50 16, hide
n1094=  edit "", 104, 195 37 40 22, hide limit 3
n1095=  check "Enable On Start", 106, 271 86 100 20, hide
n1096=  text "Filename", 107, 122 109 50 16, hide
n1097=  edit "", 108, 130 127 219 22, hide read
n1098=  button "?", 113, 351 127 17 21, hide
n1099=  text "Note", 109, 121 152 50 16, hide
n1100=  edit "", 110, 130 168 239 22, hide
n1101=  text "Channels", 111, 122 195 50 16, hide
n1102=  edit "", 112, 130 211 239 22, hide
n1103=  text "mins", 105, 240 42 26 16, hide
n1104=  text "1", 114, 361 12 11 16, hide
n1105=  text "Sent:", 115, 122 65 70 16, hide
n1106=  edit "", 116, 195 59 40 22, hide read
n1107=  button "Reset", 117, 237 59 35 21, hide
n1108=  ;------------------------
n1109=
n1110=  ;---### XDCC
n1111=  icon 400, 334 37 32 32, system\images\fs.ico, hide
n1112=
n1113=  text "Max Sends:", 480, 128 148 98 16, hide
n1114=  edit "", 481, 227 145 38 22, hide
n1115=  text "Max Sends User:", 482, 128 171 98 16, hide
n1116=  edit "", 483, 227 168 38 22, hide
n1117=  text "Max Queues:", 484, 128 194 98 16, hide
n1118=  edit "", 485, 227 191 38 22, hide
n1119=  text "Max Queue User:", 486, 128 217 98 16, hide
n1120=  edit "", 487, 227 214 38 22, hide
n1121=  check "Respond to !list", 471, 128 38 138 16, hide
n1122=  check "Enable XDCC Server", 470, 128 20 152 16, hide
n1123=  check "Clear Queue on exit", 472, 128 56 152 16, hide
n1124=  check "Adverts on all Channels", 473, 128 74 152 16, hide
n1125=  check "Advertise every", 474, 128 108 100 16, hide
n1126=  edit "", 475, 227 106 38 22, hide
n1127=  text "Request Method", 477, 300 149 95 16, hide
n1128=  radio "/msg", 478, 308 169 80 16, hide
n1129=  radio "/ctcp", 479, 308 190 80 16, hide
n1130=  text "mins", 476, 267 110 29 16, hide
n1131=  ;--------
n1132=  list 420, 114 6 301 240, size hide
n1133=  list 430, 114 6 301 240, size hide
n1134=  list 440, 114 6 301 240, size hide
n1135=
n1136=}
n1137=alias fs.titlebc {
n1138=  var %f = Fserv, %x = XDCC
n1139=  if ($1 == 2) var %a = %f Stats
n1140=  if ($1 == 22) var %a = %f Trigs
n1141=  if ($1 == 23) var %a = %f Settings
n1142=  if ($1 == 24) var %a = %f Channels
n1143=  if ($1 == 25) var %a = %f Lists-
n1144=  if ($1 == 4)  var %a = %x Options
n1145=  if ($1 == 42)  var %a = %x Packets
n1146=  if ($1 == 43)  var %a = %x Advertising Channels
n1147=  if ($1 == 44)  var %a = %x Queues
n1148=
n1149=  if ($left($1,1) == 3) && ($len($1) > 1) var %a = $+(TDCC Trigger,$chr(32) ,$chr(35),$calc($right($1,1) - 1))
n1150=  if ($left($1,1) == 3) && ($len($1) == 1)  var %a = TDCC
n1151=  dialog -t fs File Servers [/fs]  - %a
n1152=
n1153=}
n1154=
n1155=on *:dialog:fs:close:0:{
n1156=  xdcc.makelist
n1157=  unset %f.temp
n1158=
n1159=  var %s1 = $gettok(%fs,2,169)
n1160=  unset %fs | var %b = 2,%s = $+($gettok($did($dname,2,1),4,32), $gettok($did($dname,2,1),5,32))
n1161=  while (%b < 5) {
n1162=    did -i $dname 2 1 cb root
n1163=    set %fs %fs $iif(e isin $gettok($did($dname,2,%b),1,32),$gettok($did($dname,2,%b),-1,32))) 
n1164=    inc %b
n1165=  }
n1166=  set %fs $+($iif(!%fs,blah,%fs),©,$iif(%s,%s,%s1) )
n1167=
n1168=}
n1169=on *:dialog:fs:init:0:{
n1170=  mdx.fonts $dname 200,201,420,430,440, $+ $+($count.id(2,7),$chr(44),$count.id(29,49),$chr(44),$count.id(101,117),$chr(44),$count.id(225,231),$chr(44),$count.id(470,487))
n1171=  mdx.buttons $dname 3,4
n1172=  mdx SetControlMDX 2 treeview $rcon(display,tv.style) > $views
n1173=  if ($rcon(display,tv.setrowh) == on) {  did -i $dname 2 1 setitemheight $rcon(display,tv.rowh) }
n1174=
n1175=  did -a $dname 2 $+(+b,$iif(file isin %fs,e)) FileServer
n1176=  did -a $dname 2 $+(+b,$iif(tdc isin %fs,e)) TDCC
n1177=  did -a $dname 2 $+(+b,$iif(xdcc isin %fs,e)) XDCC
n1178=
n1179=
n1180=  did -i $dname 2 1 cb root 2
n1181=  did -a $dname 2 Trigs
n1182=  did -a $dname 2 Settings
n1183=  did -a $dname 2 Channels
n1184=  did -a $dname 2 Lists-
n1185=  did -i $dname 2 1 cb root 3
n1186=  did -a $dname 2 No. 1
n1187=  did -a $dname 2 No. 2
n1188=  did -a $dname 2 No. 3
n1189=  did -a $dname 2 No. 4
n1190=  did -a $dname 2 No. 5
n1191=  did -i $dname 2 1 cb root 4
n1192=  did -a $dname 2 Packets
n1193=  did -a $dname 2 Channels
n1194=  did -a $dname 2 Queues
n1195=  ;-------------
n1196=  loadbuf -o $dname 31 $+($prodir,fserv.txt)
n1197=  did -h $dname 31
n1198=  mdx SetControlMDX $dname 5 listview icon smallicons alignleft rowselect showsel single labeltip $rcon(display,list.style) > $views 
n1199=  did -i $dname 5 1 headerdims 65:1 45:2 90:3 90:3
n1200=  did -i $dname 5 1 headertext Trigs $+ $chr(9) $+ On $+ $chr(9) $+ Dir $+ $chr(9) $+ Welcome
n1201=  did -i fs 5 1 seticon list 0 system\images\fs.ico
n1202=
n1203=  fs.loadtrigs
n1204=
n1205=  mdx SetControlMDX $dname 6 listview icon smallicons rowselect showsel single labeltip $rcon(display,list.style) > $views 
n1206=  did -i $dname 6 1 headerdims 75:1 222:2
n1207=  did -i $dname 6 1 headertext Server $chr(9) Channels
n1208=  did -i fs 6 1 seticon list 0 system\images\server.ico
n1209=  fs.loadchans
n1210=
n1211=  var %d = did -ra $dname
n1212=  %d 33 $rcon(fserv,fs.note) | %d 36 $rcon(fserv,fs.mxSu) | %d 38 $rcon(fserv,fs.mxSt) 
n1213=  %d 41 $rcon(fserv,fs.mxQu) | %d 43 $rcon(fserv,fs.mxQt) | %d 45 $rcon(fserv,fs.int) | %d 47 $rcon(fserv,fs.mxusers)
n1214=  if ($rcon(fserv,fs.start) == on) { did -c $dname 48 }
n1215=  if ($rcon(fserv,fs.list) == on) { did -c $dname 29 }
n1216=  ;-------------
n1217=  mdx SetControlMDX $dname 200 listview rowselect showsel single $rcon(display,list.style) > $views 
n1218=  did -i $dname 200 1 headerdims 90:1 175:2 
n1219=  did -i $dname 200 1 headertext Stat $chr(9) - 
n1220=  fs.loadstats
n1221=  ;-------
n1222=
n1223=  mdx SetControlMDX $dname 225 listview rowselect showsel single labeltip $rcon(display,list.style) > $views 
n1224=  did -i $dname 225 1 headerdims 80:1 80:2 130:3 
n1225=  did -i $dname 225 1 headertext Nick $chr(9) Network $chr(9) File | load.queues
n1226=
n1227=
n1228=
n1229=  mdx SetControlMDX $dname 229 listview rowselect showsel single labeltip $rcon(display,list.style) > $views 
n1230=  did -i $dname 229 1 headerdims 135:1 150:2 
n1231=  did -i $dname 229 1 headertext Hostmask $chr(9) Reason | load.fsbans
n1232=
n1233=  mdx SetControlMDX $dname 228 listview rowselect showsel single labeltip $rcon(display,list.style) > $views 
n1234=  did -i $dname 228 1 headerdims 85:1 85:2 100:3
n1235=  did -i $dname 228 1 headertext Nick $chr(9) IP Address  $chr(9) Current Dir | load.activefs
n1236=  ;  ---------------
n1237=
n1238=  ;--------###xdcc packets
n1239=
n1240=  mdx SetControlMDX $dname 420 listview icon smallicons rowselect showsel single $rcon(display,list.style) > $views 
n1241=  did -i $dname 420 1 headerdims 48:1 90:2 120:3
n1242=  did -i $dname 420 1 headertext Num $chr(9) File $chr(9) Description
n1243=  did -i fs 420 1 seticon list 0 system\images\fs.ico
n1244=
n1245=  ;--xdcc chans
n1246=  mdx SetControlMDX $dname 430 listview icon smallicons rowselect showsel single labeltip $rcon(display,list.style) > $views 
n1247=  did -i $dname 430 1 headerdims 75:1 222:2
n1248=  did -i $dname 430 1 headertext Server $chr(9) Channels
n1249=  did -i fs 430 1 seticon list 0 system\images\server.ico
n1250=  ;--xdcc queues
n1251=  mdx SetControlMDX $dname 440 listview rowselect showsel single labeltip $rcon(display,list.style) > $views 
n1252=  did -i $dname 440 1 headerdims 80:1 80:2 130:3
n1253=  did -i $dname 440 1 headertext Nick $chr(9) Network $chr(9) File | load.queues
n1254=
n1255=  var %d = did -ra $dname
n1256=  %d 481 $rcon(xdcc,sendtotal) | %d 483 $rcon(xdcc,senduser) | %d 485 $rcon(xdcc,qtotal) 
n1257=  %d 487 $rcon(xdcc,quser) | %d 475 $rcon(xdcc,adv.t) 
n1258=  if ($rcon(xdcc,status) == on) { did -c $dname 470 }
n1259=  if ($rcon(xdcc,listr) == on) { did -c $dname 471 }
n1260=  if ($rcon(xdcc,clearq) == on) { did -c $dname 472 }
n1261=  if ($rcon(xdcc,serveall) == on) { did -c $dname 473 }
n1262=  if ($rcon(xdcc,adv) == on) { did -c $dname 474 }
n1263=
n1264=  if ($rcon(xdcc,reqmeth) == /msg) { did -c $dname 478 }
n1265=  if ($rcon(xdcc,reqmeth) == /ctcp) { did -c $dname 479 }
n1266=
n1267=
n1268=  xdcc.loadchan
n1269=  xdcc.loadpack
n1270=  xdcc.loadqueues
n1271=
n1272=
n1273=
n1274=  var %topic = $gettok(%fs,2,169)
n1275=  var %r = $replace($remtok(2 22 23 24 25 3 32 33 34 35 36 4 42 43 44 ,%topic,1,32),$chr(32),$chr(44))
n1276=  did -h $dname $load.fs( [ %r ) ]
n1277=  did -v $dname $load.fs( [ %topic ) ]
n1278=  fs.titlebc %topic
n1279=  if ((%topic >= 32)  && (%topic <= 36)) {  load.fstdcc %topic    }
n1280=
n1281=
n1282=  did -a $dname 227 Active Fservs
n1283=  did -a $dname 227 Queues
n1284=  did -a $dname 227 Banned Users
n1285=  did -c $dname 227  1
n1286=  set %f.temp 1 
n1287=  if (%topic == 25) { load.fslistswitch }
n1288=}
n1289=alias fs.activepop {
n1290=  if ($1 == rem) { close -f $2 | load.activefs }
n1291=  if ($1 == clr) { var %a = $$?!="Are you sure you want to close ALL Fservs?" |  if (%a) { close -f | load.activefs } }
n1292=  if ($1 == refresh) load.activefs
n1293=}
n1294=alias load.activefs {
n1295=  var %a = 1 | did -r fs 228
n1296=  while ($fserv(%a)) {
n1297=    did -a fs 228 $fserv(%a) $chr(9) $fserv(%a).ip $chr(9) $fserv(%a).cd
n1298=    inc %a
n1299=  }
n1300=}
n1301=alias load.fsbans {
n1302=  var %b = 1 | did -r fs 229
n1303=  while ($read($+($prodir,fs_bans.txt),%b)) {
n1304=    did -a fs 229 $ifmatch
n1305=    inc %b
n1306=  }
n1307=
n1308=}
n1309=alias fs.loadstats {
n1310=  did -ra fs 200 Accessed $chr(9) $rcon(fserv,fs.access)  
n1311=  did -a fs 200 Active Fservs $chr(9) $fserv(0) user(s)
n1312=  did -a fs 200 Triggers $chr(9) $fs(ad,trign) enabled
n1313=  did -a fs 200 Queues $chr(9) $queue(0) file(s)
n1314=  did -a fs 200 Bans $chr(9) $fs(banN) user(s)
n1315=  did -a fs 200 ------ $chr(9) -----------
n1316=  did -a fs 200 Total Sends $chr(9) $rcon(transfers,sends)  
n1317=  did -a fs 200 Failed Sends $chr(9) $rcon(transfers,sfailed)
n1318=  did -a fs 200 Bytes Sent $chr(9) $bytes($rcon(transfers,sbytes)).suf
n1319=  did -a fs 200 Record CPS $chr(9) $rcon(transfers,Scps) to $rcon(transfers,scpsn)
n1320=  did -a fs 200 ------ $chr(9) -----------
n1321=  did -a fs 200 Total Gets $chr(9) $rcon(transfers,gets)  
n1322=  did -a fs 200 Failed Gets $chr(9) $rcon(transfers,gfailed)
n1323=  did -a fs 200 Bytes Gotten $chr(9) $bytes($rcon(transfers,gbytes)).suf
n1324=  did -a fs 200 Record CPS $chr(9) $rcon(transfers,Gcps) to $rcon(transfers,gcpsn)
n1325=
n1326=}
n1327=alias fs.loadtrigs {
n1328=  did -r fs 5 | var %a = 1
n1329=  while ($ini($+($prodir,opt.ini),fserv:trigs,%a)) {
n1330=    var %n = $ini($+($prodir,opt.ini),fserv:trigs,%a)
n1331=    var %t = $rcon(fserv:trigs,%n)
n1332=    did -a fs 5 0 1 %n $chr(9) $gettok(%t,1,169) $chr(9) $gettok(%t,2,169) $chr(9) $gettok(%t,3,169)
n1333=    inc %a
n1334=  }
n1335=}
n1336=alias fs.trigpopc {
n1337=  var %d = $+(",$prodir,opt.ini,")
n1338=  var %txt = $rcon(fserv:trigs,$2)
n1339=  var %e = $iif($gettok($rcon(fserv:trigs,$2),1,169) == On,Off,On)
n1340=  if ($1 == toggle) { writeini %d fserv:trigs $2 $puttok(%txt,%e,1,169) | fs.loadtrigs }
n1341=  if ($1 == add) {   var %t = $$?="Trigger Name:" | var %dir = $$sdir="Choose Folder to Share" | var %w = $sfile(system\,Choose Welcome Text, ok) |  if (%t) && (%dir) { $wcon(fserv:trigs,%t,$+(No,©,%dir,©,$iif(%w,%w,none))) | fs.loadtrigs } }
n1342=  if ($1 == rem) { var %a = $$?!="Delete?" | if (%a) { remini $+($prodir,opt.ini) fserv:trigs $2 | fs.loadtrigs } }
n1343=  if ($1 == browse)  { run $nofile($2) }
n1344=}
n1345=alias fs.banpop {
n1346=  var %f = $+($prodir,fs_bans.txt)
n1347=  if ($1 == add) {
n1348=    var %h = $$?="Hostmask:   nick!user@host $crlf $crlf Wildcards are accepted" |  var %r = $$?="Reason:"
n1349=    if (* !isin %h) && ($chr(33) !isin %h) var %h = %h $+ !*@*
n1350=    if (%r) && (%h) { write -a %f %h $chr(9) %r | load.fsbans }
n1351=  }
n1352=  if ($1 == rem) { write $+(-dl,$2) %f | load.fsbans }
n1353=  if ($1 == clr) { var %y = $$?!="Clear all banned users?" | if (%y) { write -c %f | load.fsbans } }
n1354=}
n1355=
n1356=
n1357=alias fs.loadchans {
n1358=  did -r fs 6 | var %a = 1
n1359=  while ($ini($+($prodir,opt.ini),fserv:chans,%a)) { var %n = $ini($+($prodir,opt.ini),fserv:chans,%a) | did -a fs 6 0 1 %n $chr(9) $rcon(fserv:chans,%n) | inc %a }
n1360=}
n1361=alias xdcc.loadchan {
n1362=  did -r fs 430 | var %a = 1
n1363=  while ($ini($+($prodir,opt.ini),xdcc:chans,%a)) { var %n = $ini($+($prodir,opt.ini),xdcc:chans,%a) | did -a fs 430 0 1 %n $chr(9) $rcon(xdcc:chans,%n) | inc %a }
n1364=}
n1365=alias xdcc.loadpack {
n1366=  did -r fs 420  |  var %a = 1, %f = $+($prodir,xdcc.txt)
n1367=  while (%a <= $lines(%f)) {
n1368=    var %t = $read(%f,%a)
n1369=    did -a fs 420 0 1 $+($chr(35),%a) $chr(9) $nopath($gettok(%t,1,169)) $chr(9) $gettok(%t,2,169) 
n1370=    inc %a 
n1371=  }
n1372=}
n1373=alias fs.chanpopc {
n1374=  var %d = $+($prodir,opt.ini)
n1375=  var %txt = $rcon(fserv:chans,$2)
n1376=  if ($1 == edit) { var %x = $$?="Edit Channels for $2 " | if (%x) { writeini %d fserv:chans $2 %x | fs.loadchans } }
n1377=  if ($1 == add) {  var %s = $$?="Network name:" | var %c = $$?="Channels $crlf i.e.  #help,#art,#windows" | if (%s) && (%c) { $wcon(fserv:chans,%s,%c) | fs.loadchans } }
n1378=  if ($1 == rem) { var %a = $$?!="Delete $2 ?" | if (%a) { remini $+($prodir,opt.ini) fserv:chans $2 | fs.loadchans } }
n1379=
n1380=}
n1381=alias fsx.chanpopc {
n1382=  var %d = $+($prodir,opt.ini)
n1383=  var %txt = $rcon(xdcc:chans,$2)
n1384=  if ($1 == edit) { var %x = $$?="Edit Channels for $2 " | if (%x) { writeini %d xdcc:chans $2 %x | xdcc.loadchan } }
n1385=  if ($1 == add) {  var %s = $$?="Network name:" | var %c = $$?="Channels $crlf i.e.  #help,#art,#windows" | if (%s) && (%c) { $wcon(xdcc:chans,%s,%c) | xdcc.loadchan } }
n1386=  if ($1 == rem) { var %a = $$?!="Delete $2 ?" | if (%a) { remini $+($prodir,opt.ini) xdcc:chans $2 | xdcc.loadchan } }
n1387=
n1388=}
n1389=alias fsx.packpopc {
n1390=  var %f = $+($prodir,xdcc.txt)
n1391=  var %n = $remove($2,$chr(35))
n1392=  if ($1 == browse) { if ($read(%f,%n)) { run $nofile( $gettok($read(%f,%n),1,169))  } }
n1393=  if ($1 == add) {  var %a = $$sfile($mircdir,Select a File,Ok) | var %d = $$?="Description for file" | if (%a) && (%d) { write %f $+(%a,$chr(169),%d) } | xdcc.loadpack }
n1394=  if ($1 == rem) {  if (%n isnum) { write -dl $+ %n %f | xdcc.loadpack } }
n1395=}
n1396=alias load.fs {
n1397=  if ($istok($1-,2,32) ) { var %f = %f $+ ,200 }
n1398=  if ($istok($1-,22,32) ) { var %f = %f $+ ,5 }
n1399=  if ($istok($1-,23,32)) { var %f = %f $+ ,1, $+ $count.id(29,49) }
n1400=  if ($istok($1-,24,32)) { var %f = %f $+ ,6 }
n1401=  if ($istok($1-,25,32)) { var %f = %f $+ ,225,226,227,229,228 }
n1402=  if ($istok($1-,3,32)) { var %f = %f $+ ,1,7 }
n1403=  if ($istok($1-,32,32)) { var %f = %f $+ ,1, $+ $count.id(101,117) }
n1404=  if ($istok($1-,33,32)) { var %f = %f $+ ,1, $+ $count.id(101,117) }
n1405=  if ($istok($1-,34,32)) { var %f = %f $+ ,1, $+ $count.id(101,117) }
n1406=  if ($istok($1-,35,32)) { var %f = %f $+ ,1, $+ $count.id(101,117) }
n1407=  if ($istok($1-,36,32)) { var %f = %f $+ ,1, $+ $count.id(101,117) }
n1408=  if ($istok($1-,4,32)) { var %f = %f $+ ,1,400, $+ $count.id(470,487) }
n1409=  if ($istok($1-,42,32)) { var %f = %f $+ ,420 }
n1410=  if ($istok($1-,43,32)) { var %f = %f $+ ,430 }
n1411=  if ($istok($1-,44,32)) { var %f = %f $+ ,440 }
n1412=  return $gettok(%f,1-,44)
n1413=}
n1414=alias fs.statreset { 
n1415=  var %b = $$?!="Are you sure?"
n1416=  if (%b) {
n1417=    var %a = 1,%dir = $+($prodir,opt.ini)
n1418=    while ($ini(%dir,transfers,%a)) {
n1419=      var %n = $ini(%dir,transfers,%a)
n1420=      writeini %dir transfers %n 00
n1421=      inc %a
n1422=    }
n1423=    writeini %dir fserv fs.access 00
n1424=    fs.loadstats
n1425=  }
n1426=}
n1427=alias load.fslistswitch {
n1428=  if (%f.temp == 1) { did -v $dname 228 | did -h $dname 229,225 }
n1429=  if (%f.temp == 2) { did -v $dname 225 | did -h $dname 229,228 }
n1430=  if (%f.temp == 3) { did -v $dname 229 | did -h $dname 228,225 }
n1431=}
n1432=alias fs.quepopc {
n1433=  var %q.d = $prodir $+ queue.txt
n1434=  var %q.a = $calc($did($dname,225).sel - 1)   
n1435=  var %q.t = $read(%q.d,%q.a)
n1436=  if ($1 == up) { if ($did($dname,225).sel isnum) { set %q.temp %q.t | write -dl $+ %q.a %q.d | write $+(-il,$calc(%q.a - 1)) %q.d %q.temp  | load.queues | did -c $dname 225 $calc(%q.a) | unset %q.temp } }
n1437=  if ($1 == dn) { if ($did($dname,225).sel isnum) { set %q.temp %q.t | write -dl $+ %q.a %q.d | write $+(-il,$calc(%q.a + 1)) %q.d %q.temp | load.queues | did -c $dname 225 $calc(%q.a + 2) | unset %q.temp } }
n1438=  if ($1 == add) { var %n = $$?="Nick" | var %nw = $$?="Network:" |  var %f = $$sfile($mircdir,Select a file,Ok) | queue %n %nw %f | load.queues }
n1439=  if ($1 == rem) { $iif(%q.a,write $+(-dl,%q.a) %q.d) | load.queues }
n1440=  if ($1 == clr) { var %c = $$?!="Delete All? " | if (%c) { write -c $+($prodir,queue.txt) | load.queues } }
n1441=  if ($1 == force) { dcc send $gettok($queue(%q.a),1,32) " $+ $gettok($queue(%q.a),2-,32) $+ " | write $+(-dl,%q.a) %q.d | load.queues }
n1442=
n1443=}
n1444=alias xdcc.quepopc {
n1445=  var %q.d = $prodir $+ queue_x.txt
n1446=  var %q.a = $calc($did($dname,440).sel - 1)   
n1447=  var %q.t = $read(%q.d,%q.a)
n1448=  if ($1 == up) { if ($did($dname,440).sel isnum) { set %q.temp %q.t | write -dl $+ %q.a %q.d | write $+(-il,$calc(%q.a - 1)) %q.d %q.temp  | xdcc.loadqueues | did -c $dname 440 $calc(%q.a) | unset %q.temp } }
n1449=  if ($1 == dn) { if ($did($dname,440).sel isnum) { set %q.temp %q.t | write -dl $+ %q.a %q.d | write $+(-il,$calc(%q.a + 1)) %q.d %q.temp | xdcc.loadqueues | did -c $dname 440 $calc(%q.a + 2) | unset %q.temp } }
n1450=  if ($1 == add) { var %n = $$?="Nick" | var %nw = $$?="Network:" |  var %f = $$sfile($mircdir,Select a file,Ok) | queue.x %n %nw %f | xdcc.loadqueues }
n1451=  if ($1 == rem) { $iif(%q.a,write $+(-dl,%q.a) %q.d) | xdcc.loadqueues }
n1452=  if ($1 == clr) { var %c = $$?!="Delete All? " | if (%c) { write -c $+($prodir,queue_x.txt) | xdcc.loadqueues } }
n1453=  if ($1 == force) { dcc send $gettok($queue.x(%q.a),1,32) " $+ $gettok($queue.x(%q.a),2-,32) $+ " | write $+(-dl,%q.a) %q.d | xdcc.loadqueues }
n1454=
n1455=}
n1456=alias load.fstdcc {
n1457=  var %t = $calc($1 - 31) 
n1458=  did -ra fs 114 %t 
n1459=  did -ra fs 102 $rcon(tdcc,$+(%t,.trig))
n1460=  did -ra fs 104 $rcon(tdcc,$+(%t,.int))
n1461=  if ($rcon(tdcc,$+(%t,.eos)) == on) { did -c fs 106 } | else did -u fs 106
n1462=  did -ra fs 108 $rcon(tdcc,$+(%t,.file))
n1463=  did -ra fs 110 $rcon(tdcc,$+(%t,.note))
n1464=  did -ra fs 112 $rcon(tdcc,$+(%t,.chan))
n1465=  did -ra fs 116 $rcon(tdcc,$+(%t,.dl))
n1466=
n1467=}
n1468=on *:dialog:fs:sclick:*:{
n1469=  if ($did == 3) {
n1470=
n1471=    if ($did(31)) { savebuf -o $calc($did($dname,31).lines - 1) $dname 31 $prodir $+ fserv.txt  }
n1472=  }
n1473=  if ($did == 2) {
n1474=    if (*lclick* iswm $gettok($did($dname,$did,1),1,32) ) {
n1475=      var %a = $gettok($did($dname,$did,1),4,32) $+ $gettok($did($dname,$did,1),5,32)
n1476=      var %r = $replace($remtok(2 22 23 24 25 3 32 33 34 35 36 4 42 43 44,%a,1,32),$chr(32),$chr(44))
n1477=      if ((%a >= 32)  && (%a <= 36)) {  load.fstdcc %a    }
n1478=      did -h $dname $load.fs( [ %r ) ]
n1479=      did -v $dname $load.fs( [ %a ) ]
n1480=      fs.titlebc %a
n1481=      if (%a == 25) { load.fslistswitch }
n1482=    }
n1483=  }
n1484=  if ($did == 5) {
n1485=    var %t = $right($gettok($did(fs,5).seltext,1,9),-11)
n1486=    var %e = $right($gettok($did(fs,5).seltext,2,9),-11)
n1487=    if (rclick != $gettok($did($dname,5,1),1,32)) halt
n1488=    popups New trigs 12 16
n1489=    pop.item trigs $iif(!%t,+d) $iif(%e == On,Disable,Enable)  $cr fs.trigpopc toggle %t
n1490=    pop.item trigs 
n1491=    pop.item trigs Add $cr fs.trigpopc add
n1492=    pop.item trigs Rem $cr fs.trigpopc rem %t
n1493=    pop.item trigs 
n1494=    pop.item trigs Browse $cr fs.trigpopc browse $right($gettok($did(fs,5).seltext,4,9),-11)
n1495=
n1496=    popit trigs $mouse.dx $mouse.dy
n1497=  }
n1498=  if ($did == 200) {
n1499=    if (rclick != $gettok($did($dname,200,1),1,32)) halt
n1500=    popups New fs.stats 12 16
n1501=    pop.item fs.stats Refresh $cr fs.loadstats
n1502=    pop.item fs.stats 
n1503=    pop.item fs.stats Reset $cr fs.statreset
n1504=    popit fs.stats $mouse.dx $mouse.dy
n1505=
n1506=  }
n1507=
n1508=  if ($did == 225) {
n1509=    if (rclick != $gettok($did($dname,225,1),1,32)) halt
n1510=    popups New fs.queues 12 16
n1511=    pop.item fs.queues Move Up $cr fs.quepopc up
n1512=    pop.item fs.queues Move Down $cr fs.quepopc dn
n1513=    pop.item fs.queues 
n1514=    pop.item fs.queues Add $cr fs.quepopc add
n1515=    pop.item fs.queues Remove $cr fs.quepopc rem
n1516=    pop.item fs.queues 
n1517=    pop.item fs.queues Clear $cr fs.quepopc clr
n1518=    pop.item fs.queues
n1519=    pop.item fs.queues Force $cr fs.quepopc force
n1520=    popit fs.queues $mouse.dx $mouse.dy
n1521=
n1522=  }
n1523=  if ($did == 6) {
n1524=    var %n = $right($gettok($did(fs,6).seltext,1,9),-11)
n1525=    if (rclick != $gettok($did($dname,6,1),1,32)) halt
n1526=    popups New fs.chans 12 16
n1527=    pop.item fs.chans $iif(!%n,+d)  Edit $cr fs.chanpopc edit %n
n1528=    pop.item fs.chans
n1529=    pop.item fs.chans Add Network $cr fs.chanpopc add
n1530=    pop.item fs.chans Rem Network $cr fs.chanpopc rem %n
n1531=    popit fs.chans $mouse.dx $mouse.dy
n1532=  }
n1533=  if ($did == 430) {
n1534=    var %n = $right($gettok($did(fs,430).seltext,1,9),-11)
n1535=    if (rclick != $gettok($did($dname,430,1),1,32)) halt
n1536=    popups New fsx.chans 12 16
n1537=    pop.item fsx.chans $iif(!%n,+d)  Edit $cr fsx.chanpopc edit %n
n1538=    pop.item fsx.chans
n1539=    pop.item fsx.chans Add Network $cr fsx.chanpopc add
n1540=    pop.item fsx.chans Rem Network $cr fsx.chanpopc rem %n
n1541=    popit fsx.chans $mouse.dx $mouse.dy
n1542=  }
n1543=  if ($did == 420) {
n1544=    var %n = $right($gettok($did(fs,420).seltext,1,9),-11)
n1545=    if (rclick != $gettok($did($dname,420,1),1,32)) halt
n1546=    popups New fsx.pack 12 16
n1547=
n1548=    pop.item fsx.pack Add  Packet $cr fsx.packpopc add
n1549=    pop.item fsx.pack Rem Packet $cr fsx.packpopc rem %n
n1550=    pop.item fsx.pack
n1551=    pop.item fsx.pack Browse Directory $cr fsx.packpopc browse %n
n1552=
n1553=    popit fsx.pack $mouse.dx $mouse.dy
n1554=  }
n1555=  if ($did == 440) {
n1556=    if (rclick != $gettok($did($dname,440,1),1,32)) halt
n1557=    popups New x.queues 12 16
n1558=    pop.item x.queues Move Up $cr xdcc.quepopc up
n1559=    pop.item x.queues Move Down $cr xdcc.quepopc dn
n1560=    pop.item x.queues 
n1561=    pop.item x.queues Add $cr xdcc.quepopc add
n1562=    pop.item x.queues Remove $cr xdcc.quepopc rem
n1563=    pop.item x.queues 
n1564=    pop.item x.queues Clear $cr xdcc.quepopc clr
n1565=    pop.item x.queues
n1566=    pop.item x.queues Force $cr xdcc.quepopc force
n1567=    popit x.queues $mouse.dx $mouse.dy
n1568=
n1569=  }
n1570=  if ($did == 228) {
n1571=    var %n = $right($gettok($did(fs,228).seltext,1,9),-11)
n1572=
n1573=    if (rclick != $gettok($did($dname,228,1),1,32)) halt
n1574=    popups New fs.active 12 16
n1575=    pop.item fs.active Remove $cr fs.activepop rem %n
n1576=    pop.item fs.active Clear All $cr fs.activepop clr
n1577=    pop.item fs.active
n1578=    pop.item fs.active Refresh $cr fs.activepop refresh
n1579=    popit fs.active $mouse.dx $mouse.dy
n1580=  }
n1581=  if ($did == 229) {
n1582=    var %n = $calc($did(fs,229).sel - 1)
n1583=    if (rclick != $gettok($did($dname,229,1),1,32)) halt
n1584=    popups New fs.bans 12 16
n1585=    pop.item fs.bans Add $cr fs.banpop add
n1586=    pop.item fs.bans Rem $cr fs.banpop rem %n
n1587=    pop.item fs.bans
n1588=    pop.item fs.bans Clear $cr fs.banpop clr
n1589=    popit fs.bans $mouse.dx $mouse.dy
n1590=  }
n1591=  ;--------------
n1592=
n1593=  if ($did == 48) { $wcon(fserv,fs.start,$iif($did(48).state == 1,on,off)) }
n1594=  if ($did == 29) { $wcon(fserv,fs.list,$iif($did(29).state == 1,on,off)) }
n1595=  ;------------
n1596=  if ($did == 227) {    set %f.temp $did(227).sel | load.fslistswitch   }
n1597=  ;------
n1598=  var %t = $did(114)
n1599=  if ($did == 106) { $wcon(tdcc,$+(%t,.eos),$iif($did($did).state == 1,on,off)) }
n1600=  if ($did == 113) { var %f = $$sfile($mircdir,Select a file to serve,Ok)  | if (%f) { $wcon(tdcc,$+(%t,.file),%f) | did -ra $dname 108 %f } }
n1601=  if ($did == 117) { $wcon(tdcc,$+(%t,.dl),00)) | did -ra $dname 116 $rcon(tdcc,$+(%t,.dl)) }
n1602=
n1603=
n1604=  ;----###xdcc
n1605=  if ($did == 470) { $wcon(xdcc,status,$iif($did($did).state == 1,on,off)) }
n1606=  if ($did == 471) { $wcon(xdcc,listr,$iif($did($did).state == 1,on,off)) }
n1607=  if ($did == 472) { $wcon(xdcc,clearq,$iif($did($did).state == 1,on,off)) }
n1608=  if ($did == 473) { $wcon(xdcc,serveall,$iif($did($did).state == 1,on,off)) }
n1609=  if ($did == 474) { $wcon(xdcc,adv,$iif($did($did).state == 1,on,off)) }
n1610=
n1611=  if (($did == 478) || ($did == 479)) {  $wcon(xdcc,reqmeth,$did($did) )) }
n1612=
n1613=}
n1614=on *:dialog:fs:edit:*:{
n1615=  if ($did == 33) { $wcon(fserv,fs.note,$did($did)) }
n1616=  if ($did == 36) { $wcon(fserv,fs.mxSu,$did($did)) }
n1617=  if ($did == 38) { $wcon(fserv,fs.mxSt,$did($did)) }
n1618=  if ($did == 41) { $wcon(fserv,fs.mxQu,$did($did)) }
n1619=  if ($did == 43) { $wcon(fserv,fs.mxQt,$did($did)) }
n1620=  if ($did == 45) { $wcon(fserv,fs.int,$did($did)) }
n1621=  if ($did == 47) { $wcon(fserv,fs.mxusers,$did($did)) }
n1622=  ;----------------
n1623=  var %t = $did(114)
n1624=  if ($did == 102) { $wcon(tdcc,$+(%t,.trig),$did($did)) }
n1625=  if ($did == 104) { $wcon(tdcc,$+(%t,.int),$did($did)) }
n1626=  if ($did == 110) { $wcon(tdcc,$+(%t,.note),$did($did)) }
n1627=  if ($did == 112) { $wcon(tdcc,$+(%t,.chan),$did($did)) }
n1628=
n1629=  ;---###xdcc
n1630=  if ($did == 475) { $wcon(xdcc,adv.t,$did($did)) }
n1631=  if ($did == 481) { $wcon(xdcc,sendtotal,$did($did)) }
n1632=  if ($did == 483) { $wcon(xdcc,senduser,$did($did)) }
n1633=  if ($did == 485) { $wcon(xdcc,qtotal,$did($did)) }
n1634=  if ($did == 487) { $wcon(xdcc,quser,$did($did)) }
n1635=
n1636=}
n1637=
n1638=
n1639=
n1640=alias queues fs
n1641=alias xdcc.loadqueues { 
n1642=  did -r fs 440 | var %a = 1
n1643=  while ($read($+($prodir,queue_x.txt),%a)) { did -a fs 440 $gettok($queue.x(%a),1,32) $chr(9) $gettok($queue.x(%a),2,32) $chr(9) $nopath($gettok($queue.x(%a),3-,32)) | inc %a } 
n1644=}
n1645=alias load.queues { 
n1646=  did -r fs 225 | var %a = 1
n1647=  while ($read($+($prodir,queue.txt),%a)) { did -a fs 225 $gettok($queue(%a),1,32) $chr(9) $gettok($queue(%a),2,32) $chr(9) $gettok($queue(%a),3-,32) | inc %a } 
n1648=}
